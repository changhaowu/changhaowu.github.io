I"çx<h1 id="computational-optimal-transport-note-part-1-theoretical-foundations">Computational Optimal Transport Note Part 1: Theoretical Foundations</h1>

<p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦å™è¿°å…³äºè®¡ç®—æœ€ä¼˜ä¼ è¾“çš„ç†è®ºéƒ¨åˆ†ï¼Œå’Œä¸€èˆ¬çš„æ•°å­¦é—®é¢˜ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä»æœ€ç®€å•çš„æƒ…å†µå¼€å§‹ä¸€æ­¥æ­¥æ³›åŒ– ï¼Œç¬¬ä¸€æ­¥æ˜¯ä»ä¸¤ä¸ª \(\sum\) ä¸­çš„æ¦‚ç‡å‘é‡ \((\mathbf{a}, \mathbf{b})\) å‡ºå‘çš„ï¼Œè€Œåæ‹“å±•åˆ°ä¸¤ä¸ªç¦»æ•£æµ‹åº¦ \((\alpha, \beta)\)ï¼Œè¿›ä¸€æ­¥åˆ°æ™®é€šçš„ä¸¤ä¸ªä»»æ„æµ‹åº¦çš„é—®é¢˜æ¡†æ¶ä¸‹</p>

<h2 id="histograms-and-measures">Histograms and Measures</h2>

<p>è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œåˆ†åˆ«åœ¨ç¦»æ•£æƒ…å†µå’Œè¿ç»­æƒ…å†µä¸‹ï¼Œå™è¿°äº†æœ€ä¼˜ä¼ è¾“ä¸­ï¼Œå¦‚ä½•æ•°å­¦åœ°å®šä¹‰ç©ºé—´ä¸­è¿è¾“çš„èµ·å§‹åœ°å’Œç›®çš„åœ°ï¼ŒåŠå…¶ä¸Šç›¸åº”çš„éœ€è¦æ¬è¿çš„è´¨é‡</p>

<p>åœ¨é—®é¢˜è®¾å®šä¸‹ï¼Œç›´æ–¹å›¾ï¼ˆHistogramï¼‰å’Œæ¦‚ç‡å‘é‡ï¼ˆProbability vectorï¼‰æ˜¯ä¸¤ä¸ªç­‰ä»·çš„æ¦‚å¿µï¼Œå¯¹äº \(\mathbf{a} \in \Sigma_{n}\)ï¼Œéƒ½è¡¨ç¤ºï¼š</p>

\[\Sigma_{n} \stackrel{\text { def. }}{=}\left\{\mathbf{a} \in \mathbb{R}_{+}^{n}: \sum_{i=1}^{n} \mathbf{a}_{i}=1\right\} .\]

<p>è¿™æ˜¯ç¦»æ•£çš„æ¦‚ç‡å‘é‡ï¼Œå…¶ä¸ç¦»æ•£æµ‹åº¦çš„åŒºåˆ«åœ¨äºï¼Œç¦»æ•£æµ‹åº¦è¿›ä¸€æ­¥çº¦æŸ \(\mathbf{a} \in \Sigma_{n}\) ä¸­è¦æ±‚éè´Ÿæ€§çš„æ¡ä»¶ï¼Œæ”¹æˆé€šè¿‡ DIrac è„‰å†²å‡½æ•°å®šä¹‰ï¼š</p>

\[\alpha=\sum_{i=1}^{n} \mathbf{a}_{i} \delta_{x_{i}}\]

<p>å…¶ä¸­ \(x_{1}, \ldots, x_{n} \in \mathcal{X}\) ä»£è¡¨ä½ç½®ï¼Œè€Œ \(\text { a } = ï¼ˆ\mathbf{a}_{i}ï¼‰\) ä»£è¡¨æƒé‡è¦æ±‚ \(\mathbf{a}_{i} &gt; 0\)ï¼Œè¿™é¿å…äº†æ²¡æœ‰æ„ä¹‰çš„ä½ç½® \(x_{i}\) å­˜åœ¨</p>

<p>é‚£ä¹ˆè¿›ä¸€æ­¥çš„ï¼Œå°±æƒ³æŠŠç¦»æ•£æµ‹åº¦æ‹“å±•åˆ°è¿ç»­æµ‹åº¦çš„æƒ…å†µï¼Œè€Œæœ€ä¼˜ä¼ è¾“çš„æ¡†æ¶ï¼Œä¸€ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹æ˜¯ï¼Œç¦»æ•£çš„æƒ…å†µå’Œè¿ç»­çš„æƒ…å†µï¼Œæ˜¯å¯ä»¥åœ¨ä¸€ä¸ªæ¡†æ¶å†…è¿›è¡Œç ”ç©¶çš„ï¼š</p>

<p>å®šä¹‰è¿ç»­æƒ…å†µä¸‹çš„ç§¯åˆ†ï¼šå¯¹äºåœ¨ç©ºé—´ \(\mathcal{X}\) ä»»æ„çš„æ‹‰ä¸œæµ‹åº¦ \(\mathcal{M}(\mathcal{X})\)ï¼Œ\(f \in \mathcal{C}(\mathcal{X})\)ï¼Œåœ¨è¿™ä¸ªæ¡†æ¶ä¸‹ï¼Œå¯¹äº \(f \in \mathcal{C}(\mathcal{X})\) çš„ç§¯åˆ†å¯¹åº”ä¸€ä¸ªç¦»æ•£æµ‹åº¦ \(\alpha\) çš„æ±‚å’Œ</p>

\[\int_{\mathcal{X}} f(x) \mathrm{d} \alpha(x)=\sum_{i=1}^{n} \mathbf{a}_{i} f\left(x_{i}\right)\]

<p>å®šä¹‰è¿ç»­æƒ…å†µä¸‹çš„æµ‹åº¦å˜æ¢ï¼šè‹¥ä»¤ \(\mathcal{X}=\mathbb{R}^{d}\)ï¼Œæœ‰æµ‹åº¦ \(\alpha\)ï¼Œå…¶ç›¸å¯¹åº”å‹’è´æ ¼æµ‹åº¦æœ‰ \(\mathrm{d} \alpha(x)=\rho_{\alpha}(x) \mathrm{d} x\)ï¼Œ\(\rho_{\alpha}=\frac{\mathrm{d} \alpha}{\mathrm{d} x}\)ï¼š</p>

\[\forall h \in \mathcal{C}\left(\mathbb{R}^{d}\right), \quad \int_{\mathbb{R}^{d}} h(x) \mathrm{d} \alpha(x)=\int_{\mathbb{R}^{d}} h(x) \rho_{\alpha}(x) \mathrm{d} x\]

<p>å¯¹ \(\alpha\) åšè¿›ä¸€æ­¥çš„è¯´æ˜ï¼š</p>

<ul>
  <li>\(\alpha \in \mathcal{M}(\mathcal{X})\) è¿™ä¸ªçº¦æŸå¯¹äºæœ€ä¼˜ä¼ è¾“æ˜¯å¾ˆå¼±çš„ï¼Œè¿™ä¸è¶³ä»¥ä¸è¦æ±‚æµ‹åº¦æ˜¯ä»¥ Dirac å‡½æ•°çš„å’Œæˆ–è€…ä¸€ä¸ªå¯†åº¦å‡½æ•°ç»™å‡ºï¼Œæœ‰æ—¶å€™ç›¸åº”çš„éœ€è¦åœ¨ä¸Šé¢çš„å‡½æ•°è¿›è¡Œä¸€äº›è¡¥å……ï¼Œå½“ \(\mathcal{X}\) ä¸æ˜¯ç´§ç©ºé—´ï¼Œè¡¥å……è¦æ±‚ \(f\) æœ‰ä¸€ä¸ªç´§çš„æ”¯æ’‘é›†</li>
  <li>å¯¹åº”äºä¹‹å‰ç¦»æ•£çš„æ¦‚ç‡æµ‹åº¦ï¼Œ\(\alpha \in \mathcal{M}_{+}^{1}(\mathcal{X})\) ä¸ºè¿ç»­æƒ…å†µä¸‹çš„æ¦‚ç‡æµ‹åº¦ï¼Œ\(\alpha(\mathcal{X})=\int_{\mathcal{X}} \mathrm{d} \alpha=1\)</li>
</ul>

<p>ä¸€äº›ç›´è§‚çš„å¯è§†åŒ–ï¼š</p>

<p style="text-align: center;"><img src="/images/2021-02-02-Computational-Optimal-Transport-Note-Part-1/Discrete_histogram_density.png" alt="Discrete_histogram_density" style="zoom:40%;" /></p>

<h2 id="assignment-and-monge-problem">Assignment and Monge Problem</h2>

<p>è¿™ä¸€éƒ¨åˆ†å¼€å§‹å®šä¹‰è’™æ—¥æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼Œç¦»æ•£çš„æƒ…å†µï¼Œåˆ©ç”¨ä»£ä»·çŸ©é˜µå®šä¹‰ï¼Œæœ‰ä¸€ä¸ªç¦»æ•£çš„ç‰¹æ®Šæƒ…å†µï¼Œå½“ç›®çš„åœ°ä¸èµ·å§‹åœ°æ•°ç›®ä¸€è‡´ï¼Œå…¶ä¸Šè´¨é‡å¹³åˆ†è´¨é‡ï¼Œå¯¹åº”ä¸€ä¸ªç½®æ¢ï¼›è¿ç»­çš„æƒ…å†µéœ€è¦å®šä¹‰å‰å‘ç®—å­ï¼ˆPush-forwardï¼‰ï¼Œè€Œåˆ©ç”¨å‰å‘ç®—å­æœ‰ç»“è®ºï¼šç©ºé—´ä¸­çš„ä¸€ä¸ªæµ‹åº¦å¯¹åº”ä¸€ä¸ªéšæœºå˜é‡</p>

<h3 id="discrete-setting">Discrete Setting</h3>

<p>é¦–å…ˆæ˜¯ç¦»æ•£çš„æƒ…å†µï¼Œç»™å‡ºä»£ä»·çŸ©é˜µ \(\left(\mathbf{C}_{i, j}\right)_{i \in  [n] , j \in [ m ]}\)ï¼Œå’Œä¸¤ä¸ªç¦»æ•£æµ‹åº¦ \(\alpha=\sum_{i=1}^{n} \mathbf{a}_{i} \delta_{x_{i}} , \; \beta=\sum_{j=1}^{m} \mathbf{b}_{j} \delta_{y_{j}}\)</p>

<p>è¦å»æ±‚ä¸€ä¸ªæ˜ å°„ \(T:\left\{x_{1}, \ldots, x_{n}\right\} \rightarrow\left\{y_{1}, \ldots, y_{m}\right\}\)ï¼Œå…¶æ»¡è¶³æ¡ä»¶ï¼š</p>

\[\forall j \in [ m ], \quad \mathbf{b}_{j}=\sum_{i: T\left(x_{i}\right)=y_{j}} \mathbf{a}_{i}\]

<p>å¯ä»¥è®°ä½œ \(T_{\#} \alpha=\beta\) ï¼Œå½“ç„¶è¿™ä¸ªæ˜ å°„æ˜¯æ»¡å°„çš„ï¼Œå¯è§†åŒ–ä¼ è¾“æ˜ å°„å¦‚ä¸‹å›¾ï¼š</p>

<p style="text-align: center;"><img src="/images/2021-02-02-Computational-Optimal-Transport-Note-Part-1/Transport_Map_Visualization.png" alt="Transport_Map_Visualization" style="zoom:40%;" /></p>

<p>æœ‰äº†ä¼ è¾“æ˜ å°„çš„å®šä¹‰ï¼Œå¯ä»¥è¿›ä¸€æ­¥å®šä¹‰è’™æ—¥æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼Œæ±‚å–æœ€å°åŒ–ä¼ è¾“ä»£ä»·çš„å‰å‘æ˜ å°„ \(T\)</p>

\[\min _{T}\left\{\sum_{i} c\left(x_{i}, T\left(x_{i}\right)\right): T_{\#} \alpha=\beta\right\} \quad (x, y) \in \mathcal{X} \times \mathcal{Y}\]

<p>åœ¨ç¦»æ•£æƒ…å†µä¸‹ï¼Œå¯ä»¥æŒ‡æ ‡æ˜ å°„ \(\sigma: [ n ] \rightarrow[m]\) ï¼Œå®šä¹‰é€† inverse ä¸º \(\sigma^{-1}(j)\) æ˜ å°„åˆ° \(j\) çš„æŒ‡æ ‡ï¼Œåˆ™æœ‰çº¦æŸï¼š</p>

\[\sum_{i \in \sigma^{-1}(j)} \mathbf{a}_{i}=\mathbf{b}_{j}\]

<p>å½“ \(n=m\) ä¸” \(\mathbf{a}_{i}=\mathbf{b}_{j}=1 / n\)ï¼Œä¹‹å‰åœ¨æœ€ä¼˜ä¼ è¾“ç¬”è®°ä¸­çš„ç»“è®ºæœ‰ï¼Œè¿™æ ·çš„æƒ…å†µä¸‹ï¼Œä¼ è¾“æ˜ å°„ \(T\) æ˜¯ä¸€ä¸ªåŒå°„ï¼Œå…¶æ˜¯ä¸€ä¸ªç½®æ¢</p>

<p>å½“ \(n&lt;m\) æ—¶ï¼Œè’™æ—¥ä¼ è¾“æ˜ å°„ä¸ä¸€å®šå­˜åœ¨ï¼Œå°±æ¯”å¦‚å¯è§†åŒ–è’™æ—¥ä¼ è¾“æ˜ å°„ä¸­çš„å›¾ä¾‹ï¼Œè‹¥åå‘è¦æ±‚ \(y\) åˆ° \(x\) çš„è’™æ—¥ä¼ è¾“ï¼Œè¿™æ˜¯ä¸å­˜åœ¨çš„</p>

<h3 id="pushing-forward-operator">Pushing-forward Operator</h3>

<p>å¯¹äºä¸€ä¸ªè¿ç»­æ˜ å°„ï¼š\(T: \mathcal{X} \rightarrow \mathcal{Y}\)ï¼Œå¯ä»¥å†è¿›ä¸€æ­¥çš„å®šä¹‰ä¸€ä¸ªåˆ†å¸ƒçš„æ˜ å°„ï¼ˆPushing-forward Operatorï¼‰ \(T_{\#}: \mathcal{M}(\mathcal{X}) \rightarrow \mathcal{M}(\mathcal{Y})\)ï¼Œæ¯”å¦‚ç¦»æ•£çš„æƒ…å†µä¸‹ï¼Œå‰å‘ç®—å­å°±æ˜¯æŠŠ \(\alpha\) çš„æ”¯æ’‘é›†å˜æ¢ä½ç½®ï¼›</p>

\[T_{\#} \alpha \stackrel{\text { def. }}{=} \sum_{i} \mathbf{a}_{i} \delta_{T\left(x_{i}\right)}\]

<p>å¯¹äº \(T: \mathcal{X} \rightarrow \mathcal{Y}\)ï¼Œå‰å‘ç®—å­æ»¡è¶³åæ ‡å˜æ¢å…¬å¼ï¼š</p>

\[\forall h \in \mathcal{C}(\mathcal{Y}), \quad \int_{\mathcal{Y}} h(y) \mathrm{d} \beta(y)=\int_{\mathcal{X}} h(T(x)) \mathrm{d} \alpha(x)\]

<p>å½“ç„¶æœ€æœ´ç´ çš„ï¼Œå°±æ˜¯è´¨é‡ä¸å˜å…¬å¼ï¼š\(\forall \; \beta \text { measurable }  B \subset \mathcal{Y}\)ï¼š</p>

\[\beta(B)=\alpha(\{x \in \mathcal{X}: T(x) \in B\})=\alpha\left(T^{-1}(B)\right)\]

<p>ç”±äºè´¨é‡ä¸å˜ï¼Œå› æ­¤å‰å‘ç®—å­çš„å˜æ¢ä»ç„¶æ˜¯ä¸€ä¸ªæµ‹åº¦ï¼Œå³ï¼š</p>

\[\alpha \in \mathcal{M}_{+}^{1}(\mathcal{X}) \Rightarrow T_{\#} \alpha \in \mathcal{M}_{+}^{1}(\mathcal{Y})\]

<h3 id="pull-back-operator">Pull-back Operator</h3>

<p>æœ‰åå‘ç®—å­ï¼Œå®šä¹‰åœ¨å‡½æ•°ä¸Šï¼š \(T^{\#}: \mathcal{C}(\mathcal{Y}) \rightarrow \mathcal{C}(\mathcal{X})\)ï¼Œå½“ç„¶ä¸ºäº†æ»¡è¶³ç±»ä¼¼å‰å‘ç®—å­çš„åæ ‡å˜æ¢å…¬å¼ï¼Œå®šä¹‰ä¸º \(\forall g \in \mathcal{C}(\mathcal{Y})\)ï¼Œ\(T^{\#} g=g \circ T\)</p>

\[\forall(\alpha, g) \in \mathcal{M}(\mathcal{X}) \times \mathcal{C}(\mathcal{Y}), \quad \int_{\mathcal{Y}} g \mathrm{~d}\left(T_{\#} \alpha\right)=\int_{\mathcal{X}}\left(T^{\#} g\right) \mathrm{d} \alpha\]

<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåå‘ç®—å­å®šä¹‰åœ¨å‡½æ•°ä¸Šï¼Œå‰å‘ç®—å­å®šä¹‰åœ¨æµ‹åº¦ä¸Šï¼Œè¿™æ˜¯ä¸ä¸€æ ·çš„ï¼š</p>

<p style="text-align: center;"><img src="/images/2021-02-02-Computational-Optimal-Transport-Note-Part-1/Push_forward_pull_back.png" alt="Push_forward_pull_back" style="zoom:40%;" /></p>

<h3 id="measures-and-random-variables">Measures and random variables</h3>

<p>è¿™ä¸ªç­‰ä»·æ€§çš„ç‰¹æ€§éå¸¸çš„é‡è¦ï¼Œå³ï¼š</p>

<p>ä¸€ä¸ª Radon æµ‹åº¦å’Œä¸€ä¸ªéšæœºå˜é‡æ˜¯ç­‰ä»·çš„ï¼Œä¸‹é¢è¯æ˜ï¼š</p>

<p>éšæœºå˜é‡ \(X: \Omega \rightarrow \mathcal{X}\)ï¼Œè€Œæ¦‚ç‡ç©ºé—´ä¸Šæœ‰æ¦‚ç‡æµ‹åº¦ \((\Omega, \mathbb{P})\)ï¼Œå¯¹åº”çš„æœ‰ Radon æµ‹åº¦ \(\alpha \in \mathcal{M}_{+}^{1}(\mathcal{X})\)ï¼Œç”±äºæ¦‚ç‡æµ‹åº¦çš„å¤§å°å®šä¹‰ä¸ºï¼š</p>

\[\forall A \in \mathcal{X}, P\left(X^{-1}(A)\right)=\alpha(A)\]

<p>å› æ­¤å¯ä»¥æŠŠ \(\alpha\) çœ‹ä½œ \(\alpha=X_{\#} \mathbb{P}\)ï¼Œç”±äºäº‹ä»¶åŸŸæ˜¯å›ºå®šçš„ï¼Œå› æ­¤ Radon æµ‹åº¦å’Œéšæœºå˜é‡æ˜¯ä¸€ä¸€å¯¹åº”çš„</p>

<p>è¿›ä¸€æ­¥çš„ï¼Œå¤åˆæ˜ å°„ä¹Ÿæ˜¯æˆç«‹çš„ï¼Œå¯¹äº \(Y=T(X):\)</p>

\[\omega \in \Omega \rightarrow T(X(\omega)) \in Y\]

<p>å› æ­¤è¿™æ˜¯ä¸€ä¸ªå‰å‘çš„å¤åˆï¼Œè¿›ä¸€æ­¥çš„ï¼Œåœ¨ \(Y\) ä¸­æŠ½æ · \(y\) ç­‰ä»·äºåœ¨ \(X\) ä¸­æŠ½æ · \(x\) åè®¡ç®— \(y=T(x)\)</p>

<p>è€Œåå›æ¥è°ˆè¿™ä¸ªç­‰ä»·æ€§ï¼Œæˆ‘ä»¬çŸ¥é“ç¦»æ•£æµ‹åº¦çš„â€œæ ¸â€ï¼šDirac å‡½æ•° \(\delta \in \mathcal{M}_{+}(\mathcal{X})\) ï¼Œå› æ­¤ç¦»æ•£æµ‹åº¦å¯ä»¥å’Œä¸€ä¸ªéšæœºå˜é‡ç­‰ä»·ï¼Œè€Œè¿ç»­æµ‹åº¦ \(\alpha \in \mathcal{M}_{+}^{1}(\mathcal{X})\)ï¼Œå½“ç„¶ä¹Ÿæ˜¯å¯ä»¥å’Œä¸€ä¸ªéšæœºå˜é‡ç­‰ä»·çš„ï¼Œè€Œä¸€ä¸ªéšæœºå˜é‡å’Œä¸€ä¸ªåˆ†å¸ƒæ˜¯ç­‰ä»·çš„ï¼Œå› æ­¤å€’å‡ºäº†ä¸€ä¸ªæƒ³æ³•ï¼Œèƒ½å¦é€šè¿‡æœ€ä¼˜ä¼ è¾“ä»£ä»·æ¥å®šä¹‰ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå½“ä¸€ä¸ªç¦»æ•£ï¼Œä¸€ä¸ªè¿ç»­æ—¶ï¼Œåé¢çš„ \(W\) è·ç¦»éƒ¨åˆ†ä¼šæ›´è¯¦ç»†çš„å™è¿°è¿™ä¸ªé—®é¢˜</p>

<h3 id="arbitrary-setting">Arbitrary Setting</h3>

<p>é€šè¿‡å®šä¹‰å‰å‘ç®—å­ï¼Œå°±å¯ä»¥å®šä¹‰ä»»æ„æµ‹åº¦æƒ…å†µä¸‹çš„è’™æ—¥æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼Œæœ‰æ¦‚ç‡æµ‹åº¦ \((\alpha, \beta)\)ï¼Œå…¶æ”¯æ’‘é›†ä¸º \((\mathcal{X}, \mathcal{Y})\)ï¼Œå¯»æ±‚ä¼ è¾“æ˜ å°„ \(T: \mathcal{X} \rightarrow \mathcal{Y}\) ä½¿ä¼ è¾“ä»£ä»·æœ€å°ï¼š</p>

\[\min _{T}\left\{\int_{\mathcal{X}} c(x, T(x)) \mathrm{d} \alpha(x): T_{\#} \alpha=\beta\right\}\]

<h2 id="kantorovich-relaxation">Kantorovich Relaxation</h2>

<p>åœ¨è’™æ—¥å½¢å¼æœ€ä¼˜ä¼ è¾“ä¸­ï¼Œæœ€å¤§çš„é—®é¢˜å°±æ˜¯ä¸€ä¸ªå§‹å‘åœ° \(x_i\) ä¸èƒ½å¯¹åº”å¤šä¸ªç›®çš„åœ° \(y_j\)ï¼Œåº·æ‰˜æ´›ç»´å¥‡å½¢å¼æ‘†è„±äº†åŸå…ˆçš„ä¼ è¾“æ˜ å°„åº”å½“æ˜¯ä¸€ä¸ªç¡®å®šæ€§ï¼ˆdeterministicï¼‰çš„æƒ³æ³•ï¼Œå˜æˆä¸€ä¸ªéšæœºæ€§ï¼ˆprobabilisticï¼‰çš„æƒ³æ³•ï¼ˆå¯èƒ½è¯´çš„æ˜¯ï¼ŒåŸæœ¬ä¼ è¾“æ˜ å°„éé›¶çš„æ¡ä»¶åœ¨åº·æ‰˜æ´›ç»´å¥‡å½¢å¼ä¸­æ¾å¼›äº†ï¼Œä» \(x_i\) å¯¹åº” \(y_j\) çš„ä¼ è¾“å¯èƒ½æ˜¯0ï¼Œè¿™ä¸€ç‚¹åŸæœ¬åœ¨ä¼ è¾“æ˜ å°„ä¸­æ˜¯ä¸ä¼šå‘ç”Ÿçš„ï¼Œç”¨éé›¶çš„æ¾å¼›æ¢äº†å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå§‹å‘åœ°å¯ä»¥ä¼ è¾“åˆ°å¤šä¸ªç›®çš„åœ°çš„æƒ³æ³•ï¼‰</p>

<p>é¦–å…ˆæ˜¯æ¦‚ç‡å‘é‡çš„æƒ…å†µï¼š</p>

<p>å…·ä½“æ¥è¯´ï¼Œæ˜¯é€šè¿‡å»ºç«‹ä¸€ä¸ªè€¦åˆçŸ©é˜µ \(\mathbf{P} \in \mathbb{R}_{+}^{n \times m}\) æ¥æ›¿ä»£åŸå…ˆçš„ä¼ è¾“æ˜ å°„ï¼Œä¸ºäº†ç¬¦åˆä¼ è¾“çš„ç‰¹æ€§ï¼Œå®šä¹‰ä¼ è¾“è®¡åˆ’ \(\mathbf{U}(\mathbf{a}, \mathbf{b})\) ä¸ºï¼š</p>

\[\mathbf{U}(\mathbf{a}, \mathbf{b}) \stackrel{\text { def. }}{=}\left\{\mathbf{P} \in \mathbb{R}_{+}^{n \times m}: \mathbf{P} \mathbb{1}_{m}=\mathbf{a} \text { and } \mathbf{P}^{\mathrm{T}} \mathbb{1}_{n}=\mathbf{b}\right\}
\\
\mathbf{P} \mathbb{1}_{m}=\left(\sum_{j} \mathbf{P}_{i, j}\right)_{i} \in \mathbb{R}^{n} \quad 

\quad \mathbf{P}^{\mathrm{T}} \mathbb{1}_{n}=\left(\sum_{i} \mathbf{P}_{i, j}\right)_{j} \in \mathbb{R}^{m}\]

<p>ç”±äºè¿™æ ·çš„å®šä¹‰ï¼Œæ¯”èµ·è’™æ—¥å½¢å¼å®šä¹‰æ¡ä»¶å¯¼è‡´çš„ä¸å¯¹ç§°æ€§ï¼Œåº·æ‰˜æ´›ç»´å¥‡å½¢å¼æ˜¯å¯¹ç§°çš„ï¼Œå³ï¼š</p>

\[\mathbf{P} \in \mathbf{U}(\mathbf{a}, \mathbf{b}) \Rightarrow \mathbf{P}^{\mathrm{T}} \in \mathbf{U}(\mathbf{b}, \mathbf{a})\]

<p>å…·ä½“çš„å®šä¹‰åº·æ‰˜æ´›ç»´å¥‡å½¢å¼æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼š</p>

\[\mathrm{L}_{\mathrm{C}}(\mathrm{a}, \mathrm{b}) \stackrel{\mathrm{def.}}{=} \min _{\mathbf{P} \in \mathrm{U}(\mathrm{a}, \mathrm{b})}\langle\mathbf{C}, \mathbf{P}\rangle \stackrel{\mathrm{def}}{=} \sum_{i, j} \mathbf{C}_{i, j} \mathbf{P}_{i, j}\]

<p>è¿™æ˜¯ä¸€ä¸ªçº¿æ€§è§„åˆ’é—®é¢˜ï¼Œå› æ­¤å¯ä»¥çŸ¥é“ï¼Œåº·æ‰˜æ´›ç»´å¥‡å½¢å¼æœ€ä¼˜ä¼ è¾“è®¡åˆ’ä¸ä¸€å®šæ˜¯å”¯ä¸€çš„</p>

<p>æ­£å¦‚ä¹‹å‰æœ€ä¼˜ä¼ è¾“ç¬”è®°ä¸­æåˆ°çš„ï¼Œå½“è’™æ—¥å½¢å¼å­˜åœ¨çš„æ—¶å€™ï¼Œåº·æ‰˜æ´›ç»´å¥‡å½¢å¼å¯èƒ½æ¯”è’™æ—¥å½¢å¼çš„ä¼ è¾“ä»£ä»·æ›´å°ï¼Œä»¥æŒ‡æ´¾é—®é¢˜ä¸ºä¾‹å­ï¼š</p>

<p>å¯¹äºç½®æ¢ \(\sigma \in \operatorname{Perm}(n)\)ï¼Œå¯ä»¥å®šä¹‰ä¼ è¾“æ˜ å°„ï¼š</p>

\[\forall(i, j) \in [ n ]^{2}, \quad\left(\mathbf{P}_{\sigma}\right)_{i, j}=\left\{\begin{array}{l}
1 / n \quad \text { if } \quad j=\sigma_{i} \\
0 \quad \text { otherwise. }
\end{array}\right.\]

<p>åˆ™è’™æ—¥å½¢å¼çš„ä¼ è¾“ä»£ä»·ä¸ºï¼š</p>

\[\left\langle\mathbf{C}, \mathbf{P}_{\sigma}\right\rangle=\frac{1}{n} \sum_{i=1}^{n} \mathbf{C}_{i, \sigma_{i}}\]

<p>è€Œé€šè¿‡åº·æ‰˜æ´›ç»´å¥‡å½¢å¼æ¥å®šä¹‰çš„è¯</p>

\[\mathbf{P} \in \mathbf{U}\left(\mathbb{1}_{n} / n, \mathbb{1}_{n} / n\right) \quad \mathbf{P}^{*}=\arg \min _{\mathbf{P} \in \mathbf{U}\left(\mathbb{1}_{n} / n, \mathbb{1}_{n} / n\right)}\langle\mathbf{C}, \mathbf{P}\rangle\]

<p>å¯ä»¥çŸ¥é“ï¼Œç½®æ¢çŸ©é˜µé›†åˆæ˜¯ \(\mathbf{U}\left(\mathbb{1}_{n} / n, \mathbb{1}_{n} /n \right)\) çš„å­é›†ï¼Œå› æ­¤åœ¨æŒ‡æ´¾é—®é¢˜ä¸­ï¼Œåº·æ‰˜æ´›ç»´å¥‡æœ€ä¼˜ä¼ è¾“ä»£ä»·ä¸å¤§äºè’™æ—¥æœ€ä¼˜ä¼ è¾“ä»£ä»·ï¼š</p>

\[\mathrm{L}_{\mathbf{C}}\left(\mathbb{1}_{n} / n, \mathbb{1}_{n} / n\right) \leq \min _{\sigma \in \operatorname{Perm}(n)}\left\langle\mathbf{C}, \mathbf{P}_{\sigma}\right\rangle\]

<p>å…¶ä»–çš„æœ€ä¼˜ä¼ è¾“é—®é¢˜ä¹Ÿæ˜¯ä¸€ä¸ªé“ç†ï¼Œæ›´ä¸è¦è¯´å¦‚æœè’™æ—¥å½¢å¼ä¸å­˜åœ¨æ—¶äº†ï¼Œå¦‚ä¸‹å›¾å³è¾¹çš„æŒ‡æ´¾é—®é¢˜ï¼š</p>

<p style="text-align: center;"><img src="/images/2021-02-02-Computational-Optimal-Transport-Note-Part-1/assignment_plus.png" alt="assignment_plus" style="zoom:40%;" /></p>

<p>é€šè¿‡ä¸Šé¢å®šä¹‰çš„æ¦‚ç‡å‘é‡çš„æƒ…å†µï¼Œç¦»æ•£æµ‹åº¦çš„æƒ…å†µæ˜¯ç±»ä¼¼å®šä¹‰çš„</p>

<p>æœ‰ç¦»æ•£æµ‹åº¦ \(\alpha, \beta\) åŠå…¶æ”¯æ’‘é›†ï¼Œåœ¨æ”¯æ’‘é›†ä¸Šå®šä¹‰ä¼ è¾“ä»£ä»·çŸ©é˜µ \(\mathrm{C}_{i, j} \stackrel{\text { def. }}{=} c\left(x_{i}, y_{j}\right)\)ï¼Œç¦»æ•£æµ‹åº¦çš„åº·æ‰˜æ´›ç»´å¥‡ä¼ è¾“é—®é¢˜ç­‰ä»·äºæ¦‚ç‡å‘é‡çš„æƒ…å†µ</p>

\[\mathcal{L}_{c}(\alpha, \beta) \stackrel{\text { def. }}{=} \mathrm{L}_{\mathbf{C}}(\mathbf{a}, \mathbf{b})\]

<p>ç„¶åæ˜¯ä¸€èˆ¬å½¢å¼çš„åº·æ‰˜æ´›ç»´å¥‡ä¼ è¾“é—®é¢˜ï¼š</p>

<p>è€¦åˆæµ‹åº¦å®šä¹‰åœ¨ \(\pi \in \mathcal{M}_{+}^{1}(\mathcal{X} \times \mathcal{Y})\) ä¸Šï¼ŒåŒæ—¶åœ¨è€¦åˆæµ‹åº¦ä¸Šåšä¸€äº›é™åˆ¶</p>

<ol>
  <li>
    <p>è€¦åˆæµ‹åº¦è¦å’Œä¹‹å‰çš„ \(\mathbf{P} \mathbb{1}_{m}=\mathbf{a} \quad \mathbf{P}^{\mathrm{T}} \mathbb{1}_{n}=\mathbf{b}\) ä¸€æ ·ï¼Œå› æ­¤æœ‰ï¼š</p>

\[P_{\mathcal{X} \#} \pi=\alpha 
\\
P_{\mathcal{Y}_{\#}} \pi=\beta\]
  </li>
  <li>
    <p>è¿›ä¸€æ­¥çš„ç”±äºå‰å‘ç®—å­çš„æ€§è´¨ï¼Œå¯ä»¥çŸ¥é“ï¼š</p>

\[\pi(A \times \mathcal{Y})=\alpha(A) \; \forall \; A \subset \mathcal{X}
\\
\pi(\mathcal{X} \times B)=\beta(B) \; \forall \;  B \subset \mathcal{Y}\]
  </li>
</ol>

<p>ç„¶åå°±æœ‰åº·æ‰˜æ´›ç»´å¥‡æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼š</p>

\[\mathcal{L}_{c}(\alpha, \beta) \stackrel{\text { def. }}{=} \min _{\pi \in \mathcal{U}(\alpha, \beta)} \int_{\mathcal{X} \times \mathcal{Y}} c(x, y) \mathrm{d} \pi(x, y)\]

<p>åˆä¹‹å‰çš„ç»“è®ºçŸ¥ï¼Œä¸€ä¸ªæµ‹åº¦ç­‰ä»·äºä¸€ä¸ªéšæœºå˜é‡ï¼Œå› æ­¤åº·æ‰˜æ´›ç»´å¥‡é—®é¢˜ä¹Ÿå¯ä»¥é€šè¿‡éšæœºå˜é‡çš„å½¢å¼ç†è§£ï¼Œå³ï¼š</p>

\[\mathcal{L}_{c}(\alpha, \beta)=\min _{(X, Y)}\left\{\mathbb{E}_{(X, Y)}(c(X, Y)): X \sim \alpha, Y \sim \beta\right\}\]

<p>ä¸‹å›¾æ˜¯è’™æ—¥å½¢å¼ä¼ è¾“é—®é¢˜çš„ä¸€ä¸ªè§£ï¼š</p>

<p style="text-align: center;"><img src="/images/2021-02-02-Computational-Optimal-Transport-Note-Part-1/Kantorovich_Solution.png" alt="Kantorovich_Solution" style="zoom:40%;" /></p>

<p>ä¸‹å›¾æ˜¯åº·æ‰˜æ´›ç»´å¥‡å½¢å¼ä¼ è¾“é—®é¢˜çš„ä¸€ä¸ªè§£ï¼š</p>

<p style="text-align: center;"><img src="/images/2021-02-02-Computational-Optimal-Transport-Note-Part-1/Kantorovich_Solution.png" alt="Kantorovich_Solution" style="zoom:40%;" /></p>

<h3 id="metric-properties-of-optimal-transport">Metric Properties of Optimal Transport</h3>

<p>å› æ­¤æ­£å¦‚ WGAN ä¸­åˆ©ç”¨æµ‹åœ°è·ç¦»å®šä¹‰ä¸¤ä¸ªä¸ç›¸äº¤çš„åˆ†å¸ƒæµå½¢ä¹‹é—´çš„è·ç¦»ï¼ŒOptimal Transport çš„ä¸€ä¸ªé‡è¦æ€§è´¨å°±æ˜¯ç”¨æ¥å®šä¹‰åˆ†å¸ƒçš„è·ç¦»ï¼Œå½“å›ºå®šä¼ è¾“ä»£ä»·çŸ©é˜µ \(\mathrm{C}\) åï¼Œå¯ä»¥è¯æ˜æœ€ä¼˜ä¼ è¾“ç»™å‡ºäº†ä¸€ä¸ªåˆ†å¸ƒä¹‹é—´çš„è·ç¦»</p>

<p>é¦–å…ˆåœ¨ç¦»æ•£æƒ…å†µä¸‹è¯æ˜ï¼š</p>

<p>ç»™å‡ºä¼ è¾“ä»£ä»· \(\mathbf{C}=\mathbf{D}^{p}=\left(\mathbf{D}_{i, j}^{p}\right)_{i, j} \in \mathbb{R}^{n \times n}\)ï¼Œ\(\mathbf{D} \in \mathbb{R}_{+}^{n \times n}\) æ˜¯ \([n]\) ä¸Šçš„ä¸€ä¸ªè·ç¦»ï¼Œæœ‰éœ€è¦æ»¡è¶³ä¸€äº›é™åˆ¶ï¼š</p>

<ul>
  <li>\(\mathbf{D} \in \mathbb{R}_{+}^{n \times n}\) æ˜¯å¯¹ç§°çš„</li>
  <li>\(\mathbf{D}_{i, j}=0\) å½“ä¸”ä»…å½“ \(i=j\)</li>
  <li>ä¸‰è§’ä¸ç­‰å¼ \(\forall(i, j, k) \in [ n ]^{3}, \mathbf{D}_{i, k} \leq \mathbf{D}_{i, j}+\mathbf{D}_{j, k}\)</li>
</ul>

<p>ç„¶åå¯ä»¥é€šè¿‡ \(\mathbf{D}\) è¯±å¯¼è·ç¦»ï¼š</p>

\[\mathrm{W}_{p}(\mathbf{a}, \mathbf{b}) \stackrel{\text { def. }}{=} \mathrm{L}_{\mathbf{D}}^{p}(\mathbf{a}, \mathbf{b})^{1 / p}\]

<p>é‚£ä¹ˆä¸€æ ·è¦éªŒè¯ \(\mathrm{W}_{p}(\mathbf{a}, \mathbf{b})\) çš„å¯¹ç§°æ€§å’Œæ­£åˆ™æ€§ï¼Œä»¥åŠä¸‰è§’ä¸ç­‰å¼ï¼Œä»…å™è¿°ä¸‰è§’ä¸ç­‰å¼ï¼š</p>

<p>æœ‰ \(\mathbf{a}, \mathbf{b}, \mathbf{c} \in \Sigma_{n}\)ï¼Œä»¥åŠ \(\mathbf{a}, \mathbf{b}\) ä¹‹é—´çš„æœ€ä¼˜ä¼ è¾“ \(\mathbf{P}\)ï¼Œ\(\mathbf{b} ,\mathbf{c}\) ä¹‹é—´çš„æœ€ä¼˜ä¼ è¾“ \(\mathbf{Q}\)ï¼Œä¸ºäº†é¿å… \(\mathbf{b}\) çš„é›¶åæ ‡åœ¨åç»­è¯æ˜ä¸­äº§ç”Ÿé—®é¢˜ï¼Œå®šä¹‰ï¼š</p>

\[\tilde{\mathbf{b}}_{j} \stackrel{\text { def. }}{=}
\begin{array}{l}
\left\{\begin{array}{ll}
\mathbf{b}_{j}  &amp; \text { if } \mathbf{b}_{j}&gt;0 \\
1 &amp; \text { else }
\end{array}\right. \\
\end{array}{}\]

<p>é€šè¿‡ \(\tilde{\mathbf{b}}_{j}\) å®šä¹‰  \(\mathbf{S} \stackrel{\text { def. }}{=} \mathbf{P} \operatorname{diag}(1 / \tilde{\mathbf{b}}) \mathbf{Q} \in \mathbb{R}_{+}^{n \times n}\)ï¼Œå¯ä»¥è¯æ˜ \(\mathbf{S} \in \mathbf{U}(\mathbf{a}, \mathbf{c})\)ï¼š</p>

\[\mathbf{S} \mathbb{1}_{n}=\mathbf{P} \operatorname{diag}(1 / \tilde{\mathbf{b}}) \mathbf{Q} \mathbb{1}_{n}=\mathbf{P}(\mathbf{b} / \tilde{\mathbf{b}})=\mathbf{P} \mathbb{1}_{\operatorname{Supp}(\mathbf{b})}=\mathbf{a}\]

<p>å…¶ä¸­ \(\mathbf{P} \mathbb{1}_{\operatorname{Supp}(\mathbf{b})}=\mathbf{P} \mathbb{1}=\mathbf{a}\) æ˜¯ç”±äºï¼Œå½“ \(\mathbf{b}_{j}=0\) æ—¶ï¼Œè¯´æ˜å¯¹åº”çš„ \(j\) å¤„æ²¡æœ‰è¿å…¥ï¼Œå³ \(\mathbf{P}_{i, j}=0\)ï¼Œ åˆ™æœ¬æ¥è®¡ç®— \(\mathbf{P} \mathbb{1}\)ï¼Œè¿™éƒ¨åˆ†ä¹Ÿä¸äº§ç”Ÿå½±å“ï¼ŒåŒç†ä¹Ÿæœ‰ \(\mathbf{S}^{\mathrm{T}} \mathbb{1}_{n}=\mathbf{c}\)ï¼Œå› æ­¤æœ‰ \(\mathbf{S} \in U(\mathbf{a}, \mathbf{c})\)ï¼Œåˆ™æœ‰ï¼š</p>

\[\begin{aligned}
\mathrm{W}_{p}(\mathbf{a}, \mathbf{c}) &amp;=\left(\min _{\mathbf{P} \in U(\mathbf{a}, \mathbf{c})}\left\langle\mathbf{P}, \mathbf{D}^{p}\right\rangle\right)^{1 / p} \leq\left\langle\mathbf{S}, \mathbf{D}^{p}\right\rangle^{1 / p}    &amp;(\mathbf{S} \text{ cost not less than } \mathbf{D})
\\
&amp;=\left(\sum_{i k} \mathbf{D}_{i k}^{p} \sum_{j} \frac{\mathbf{P}_{i j} \mathbf{Q}_{j k}}{\tilde{\mathbf{b}}_{j}}\right)^{1 / p} \leq\left(\sum_{i j k}\left(\mathbf{D}_{i j}+\mathbf{D}_{j k}\right)^{p} \frac{\mathbf{P}_{i j} \mathbf{Q}_{j k}}{\tilde{\mathbf{b}}_{j}}\right)^{1 / p}  &amp;(\text{ triangle inequality } )
\\
&amp; \leq\left(\sum_{i j k} \mathbf{D}_{i j}^{p} \frac{\mathbf{P}_{i j} \mathbf{Q}_{j k}}{\tilde{\mathbf{b}}_{j}}\right)^{1 / p}+\left(\sum_{i j k} \mathbf{D}_{j k}^{p} \frac{\mathbf{P}_{i j} \mathbf{Q}_{j k}}{\tilde{\mathbf{b}}_{j}}\right)^{1 / p}  &amp;(\text{  Minkowskiâ€™s inequality })
\\
&amp; =\mathrm{W}_{p}(\mathbf{a}, \mathbf{b})+\mathbf{W}_{p}(\mathbf{b}, c)
\end{aligned}\]

<p>å› æ­¤ç»“è®ºå¾—è¯ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“ \(0&lt;p \leq 1\) æ—¶ï¼Œ\(\mathrm{D}^{p}\) æ˜¯è·ç¦»ï¼Œä½†æ˜¯ \(\mathbf{W}_{p}(\mathbf{a}, \mathbf{b})\) ç”±äºä¸‰è§’ä¸ç­‰å¼ä¸æˆç«‹ï¼Ÿå¯¼è‡´ä¸æ˜¯è·ç¦»ï¼Œå› æ­¤è¦æ±‚ \(p \geq 1\) ï¼Œ\(\mathbf{W}_{p}(\mathbf{a}, \mathbf{b})\) æ˜¯è·ç¦»</p>

<h3 id="properties-of-optimal-transport-distance">Properties of Optimal Transport Distance</h3>

<p>è€Œå½“ \(\mathbf{W}_{p}(\mathbf{a}, \mathbf{b})\) æ¨å¹¿åˆ°ä»»æ„çš„æµ‹åº¦ï¼ˆè¿ç»­ï¼‰æ˜¯ç±»ä¼¼çš„å®šä¹‰æ–¹æ³•ï¼Œæˆ–è€…è¯´æ˜¯åœ¨ä¸€ä¸ªæ¡†æ¶ä¸‹åšå®šä¹‰çš„ï¼Œè¿™ä¸ªå¯å‘æˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿé€šè¿‡ \(\mathbf{W}_{p}(\mathbf{a}, \mathbf{b})\) æ¥å®šä¹‰è¿ç»­æµ‹åº¦å’Œç¦»æ•£æµ‹åº¦ä¹‹é—´çš„è·ç¦»ï¼Ÿå®é™…ä¸Š \(\mathbf{W}_{p}(\mathbf{a}, \mathbf{b})\) ç¡®å®å¯ä»¥è¿™æ ·åšï¼Œä¸‹é¢ä¸¾ä¸¤ä¸ªä½“ç°æœ€ä¼˜ä¼ è¾“è·ç¦»æ¯”è¾ƒå¥½çš„ä¾‹å­ï¼Œå¹¶è¯´æ˜ç›¸å…³çš„æ€§è´¨</p>

<h4 id="weak-convergence">Weak Convergence</h4>

<p>å¯¹äºä¼ ç»Ÿçš„è·ç¦»å®šä¹‰ï¼Œæ¯”å¦‚ \(L^{2}\) è·ç¦»ï¼Œè¦æ±‚ä¸¤ä¸ªæµ‹åº¦çš„æ”¯æ’‘é›†ä¸€è‡´ \(\operatorname{supp}(\alpha) = \operatorname{supp}(\beta)\) ï¼Œæœ€ä¼˜ä¼ è¾“å®šä¹‰çš„è·ç¦»ä¸è¦æ±‚è¿™ä¹ˆä¸¥æ ¼ï¼Œè¿›ä¸€æ­¥çš„ï¼Œå°±ç®— \(\operatorname{supp}(\alpha) = \operatorname{supp}(\beta)\) çš„æƒ…å†µä¸‹ï¼Œå¼ºè¡Œæ‰©å¼ å®šä¹‰åŸŸï¼Œä½¿å¾—ç§¯åˆ†å¯ç§¯ï¼Œä¹Ÿæœ‰å¯ä»¥ä½“ç°æœ€ä¼˜ä¼ è¾“è·ç¦»æ¯”è¾ƒå¥½çš„ä¾‹å­ï¼š</p>

<p>ç ”ç©¶ç¦»æ•£å‡åŒ€åˆ†å¸ƒ \(\alpha\)ï¼Œ å®šä¹‰åœ¨ \(\{0,1 / N, 2 / N, \ldots, 1\}\) ä¸Šï¼š</p>

\[\alpha=\sum_{i=1}^{N} \frac{1}{N} \delta x_{i} \quad \operatorname{supp}(\alpha)=\{0,1 / N,..., 1\}\]

<p>å’Œè¿ç»­å‡åŒ€åˆ†å¸ƒ \(\beta=U(0,1)\)ï¼Œä»å®è·µçš„è§’åº¦ä¸Šæ¥è¯´ï¼Œå½“ \(N \rightarrow \infty\) æ—¶ï¼Œä¸¤ä¸ªåˆ†å¸ƒå‡ ä¹æ˜¯ä¸€æ ·çš„ï¼š</p>

<p style="text-align: center;"><img src="/images/2021-02-02-Computational-Optimal-Transport-Note-Part-1/Uniform-Distribution-Types.png" alt="Uniform-Distribution-Types" style="zoom:100%;" /></p>

<p>ä½†æ˜¯å– \(L^2\) è·ç¦»çš„è¯ï¼Œ \(L^2(\alpha,\beta)=1\)ï¼Œå¯¹æ¯”æœ€ä¼˜ä¼ è¾“è·ç¦»ä¸º \(\mathcal{W}_{p}(\alpha,\beta)=1/N\)ï¼Œéå¸¸å¥½çš„ä½“ç°äº†ä¸¤ä¸ªåˆ†å¸ƒæ¸è¿›ä¸€è‡´çš„æ€§è´¨ï¼Œæˆ–è€…è¯´ï¼Œå½“ \(N \rightarrow \infty\) æ—¶æœ‰ï¼Œ \(\alpha \rightarrow \beta\) ï¼ˆå¼±æ”¶æ•›ï¼‰</p>

<p>\(\mathcal{W}_{p}\) æ˜¯å¼±æ”¶æ•›çš„è·ç¦»ï¼Œå®šä¹‰å¼±æ”¶æ•›ï¼šåœ¨ç´§ç©ºé—´ä¸­ \(\mathcal{X}\)ï¼Œæœ‰ä¸€åˆ— \(\left(\alpha_{k}\right)_{k}\) å¼±æ”¶æ•›åˆ° \(\alpha \in \mathcal{M}_{+}^{1}(\mathcal{X})\) \(\Leftrightarrow\) \(\forall g \in \mathcal{C}(\mathcal{X}), \int_{\mathcal{X}} g \mathrm{~d} \alpha_{k} \rightarrow \int_{\mathcal{X}} g \mathrm{~d} \alpha\)</p>

<p>é‚£ä¹ˆæœ€ä¼˜ä¼ è¾“è·ç¦»æ˜¯èƒ½å¤Ÿä½“ç°è¿™æ ·çš„æ€§è´¨çš„</p>

<h4 id="translations">Translations</h4>

<p>æœ€ä¼˜ä¼ è¾“è·ç¦»ï¼Œå¯ä»¥åˆ†ç¦»å‡º Translation ç®—å­çš„å½±å“ï¼Œå³æŠŠç©ºé—´ä¸­çš„ç‚¹æ²¿ä¸€ä¸ªå‘é‡å˜æ¢ \(\tau\) ï¼š</p>

\[T_{\tau}: x \mapsto x-\tau\]

<p>åˆ™è¿›ä¸€æ­¥å¯ä»¥åˆ©ç”¨ \(T_{\tau}\) å»å®šä¹‰å‰å‘ç®—å­å˜æ¢åˆ†å¸ƒ \(T_{\tau \#} \alpha\)ï¼Œå‘ç°å˜æ¢çš„æ•ˆæœå¯ä»¥åˆ†ç¦»å‡ºæ¥ï¼š</p>

\[\mathcal{W}_{2}\left(T_{\tau {\#}} \alpha, T_{\tau {\#}} \beta\right)^{2}=\mathcal{W}_{2}(\alpha, \beta)^{2}-2\left\langle\tau-\tau^{\prime}, \mathbf{m}_{\alpha}-\mathbf{m}_{\beta}\right\rangle+\left\|\tau-\tau^{\prime}\right\|^{2}\]

<p>è¿™é‡Œçš„ \(\mathbf{m}_{\alpha} \stackrel{\text { def. }}{=} \int_{\mathcal{X}} x \mathrm{~d} \alpha(x) \in \mathbb{R}^{d}\) æ˜¯åˆ†å¸ƒ \(\alpha\) çš„æœŸæœ›ï¼Œé‚£ä¹ˆç‰¹åˆ«çš„æœ‰ï¼š</p>

\[\mathcal{W}_{2}(\alpha, \beta)^{2}=\mathcal{W}_{2}(\tilde{\alpha}, \tilde{\beta})^{2}+\left\|\mathbf{m}_{\alpha}-\mathbf{m}_{\beta}\right\|^{2}\]

<p>è¿™é‡Œçš„ \((\tilde{\alpha}, \tilde{\beta})\) æ˜¯æœŸæœ›ä¸ºåŸç‚¹çš„åˆ†å¸ƒï¼Œè®¡ç®—ä¸Šçš„æ€§è´¨å¾ˆå¥½</p>

<h2 id="dual-problem">Dual Problem</h2>

<p>åº·æ‰˜æ´›ç»´å¥‡é—®é¢˜æ˜¯é€šè¿‡å®šä¹‰å¯¹å¶é—®é¢˜ï¼š</p>

\[\mathrm{L}_{\mathbf{C}}(\mathbf{a}, \mathbf{b})=\max _{(\mathbf{f}, \mathbf{g}) \in \mathbf{R}(\mathbf{C})}\langle\mathbf{f}, \mathbf{a}\rangle+\langle\mathbf{g}, \mathbf{b}\rangle
\\
\mathbf{R}(\mathbf{C}) \stackrel{\text { def }}{=}\left\{(\mathbf{f}, \mathbf{g}) \in \mathbb{R}^{n} \times \mathbb{R}^{m}: \forall(i, j) \in [ n ] \times [ n ], \mathbf{f} \oplus \mathbf{g} \leq \mathbf{C}\right\} .\]

<p>åº·æ‰˜æ´›ç»´å¥‡å¯¹å¶æ€§å¯ä»¥ç”±æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§å¾—å‡ºï¼Œé€šè¿‡æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§è½¬åŒ– \(\mathbf{R}(\mathbf{C})\) ï¼Œä¸‹é¢è¯æ˜è¿™ä»ç„¶æ˜¯åŸé—®é¢˜ï¼š</p>

\[\min _{\mathbf{P} \geq 0} \max _{(\mathbf{f}, \mathbf{g}) \in \mathbb{R}^{n} \times \mathbb{R}^{m}}\langle\mathbf{C}, \mathbf{P}\rangle+\left\langle\mathbf{a}-\mathbf{P} \mathbb{1}_{m}, \mathbf{f}\right\rangle+\left\langle\mathbf{b}-\mathbf{P}^{\mathrm{T}} \mathbb{1}_{n}, \mathbf{g}\right\rangle\]

<p>å½“è€ƒè™‘æœ‰é™ç»´çš„çº¿æ€§è§„åˆ’æ—¶ï¼Œå¯ä»¥è½¬æ¢ \(\min\max\) ä¸º \(\max\min\) æœ‰ï¼š</p>

\[\max _{(\mathbf{f}, \mathbf{g}) \in \mathbb{R}^{n} \times \mathbb{R}^{m}}\langle\mathbf{a}, \mathbf{f}\rangle+\langle\mathbf{b}, \mathbf{g}\rangle+\min _{\mathbf{P} \geq 0}\left\langle\mathbf{C}-\mathbf{f} \mathbb{1}_{m}{ }^{\mathrm{T}}-\mathbb{1}_{n} \mathbf{g}^{\mathrm{T}}, \mathbf{P}\right\rangle\]

<p>ç”±äºæ˜¯å– \(\min\) ï¼Œå¯ä»¥çŸ¥ï¼š</p>

\[\min _{\mathbf{P} \geq 0}\langle\mathbf{Q}, \mathbf{P}\rangle=\left\{\begin{array}{ll}
0 &amp; \text { if } \quad \mathbf{Q} \geq 0 \\
-\infty &amp; \text { otherwise }
\end{array}\right.\]

<p>å› æ­¤è¿™ä¸ªæ¡ä»¶ç­‰ä»·äº \(\mathbf{C}-\mathbf{f} \mathbb{1}_{m}{ }^{\mathrm{T}}-\mathbb{1}_{n} \mathbf{g}^{\mathrm{T}}=\mathbf{C}-\mathbf{f} \oplus \mathbf{g} \geq 0\)ï¼Œè¿™ä»ç„¶æ˜¯åº·æ‰˜æ´›ç»´å¥‡å¯¹å¶æ€§é—®é¢˜ï¼Œé€šè¿‡æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§çŸ¥åˆ°åº·æ‰˜æ´›ç»´å¥‡æœ€ä¼˜ä¼ è¾“è®¡åˆ’çš„æ”¯æ’‘é›†åœ¨æ­£å¥½è¾¾æˆå¯¹å¶æ€§çš„é›†åˆä¸­ï¼š</p>

\[\left\{(i, j) \in  [n] \times [m]: \mathbf{P}_{i, j}&gt;0\right\} 
\subset
\left\{(i, j) \in [n] \times [m]: \mathbf{f}_{i}+\mathbf{g}_{j}=\mathbf{C}_{i, j}\right\}\]

<h3 id="intuitive-presentation">Intuitive Presentation</h3>

<p>åº·æ‰˜æ´›ç»´å¥‡å¯¹å¶æ€§ï¼Œä¹Ÿå¯ä»¥ç”±ä¸€ä¸ªä¾‹å­æ¥æŠŠæ¡ä¸€ä¸‹ï¼Œç”±ä¹‹å‰çš„åœ¨æœ€ä¼˜ä¼ è¾“ç¬”è®°ä¸­æ‰€å†™çš„ä¸€æ ·ï¼Œåº·æ‰˜æ´›ç»´å¥‡å½¢å¼çš„åŸé—®é¢˜å¯ä»¥å…¥å¦‚æ˜¯ç†è§£ï¼šæœ€å°çš„ä»£ä»·å»æŠŠçŸ¿ä¸Šçš„èµ„æºæ¨åˆ°å„åœ°çš„å·¥å‚ä¸­ï¼Œé—®é¢˜çš„è§£ä¸ºæœ€ä¼˜ä¼ è¾“è®¡åˆ’ \(\mathrm{P}^{\star}\)ï¼Œæœ€ä¼˜ä¼ è¾“ä»£ä»·ä¸º \(\left\langle\mathbf{P}^{\star}, \mathbf{C}\right\rangle\)</p>

<p>å½“ç„¶ä¹Ÿæœ‰å­˜åœ¨è¿™æ ·çš„æƒ…å†µï¼šçŸ¿ä¸»ä¸æ˜¯è‡ªå·±è¿çš„ï¼Œï¼ˆå› ä¸ºä»–ä¸ä¼šç®—æœ€ä¼˜ä¼ è¾“æ–¹æ¡ˆè¿™æ ·çš„ç†ç”±ï¼‰è€Œæ˜¯å§”æ‰˜ç»™åˆ«äººè¿ï¼ˆå½“ç„¶å‡è®¾è¿™ä¸ªä¸–ç•Œä¸­ï¼Œè‡ªå·±è¿çš„å®é™…ä»£ä»·ä¸å°äºåˆ«äººè¿çš„å®é™…ä»£ä»·ï¼‰ï¼Œè½¬è¿å•†çš„æ–¹æ¡ˆæ˜¯åœ¨çŸ¿\(i\) æ”¶ä¸€ç¬”è£…è½½è´¹ç”¨ \(\mathbf{f}_{i}\) ï¼Œè€Œåœ¨å·¥å‚ \(j\) æ”¶ä¸€ç¬”å¸è´§è´¹ \(\mathbf{g}_{j}\)ï¼Œè€ŒåŒæ—¶æœ‰ä¸¤ä¸ªåˆ†å¸ƒ \(\mathbf{a}\) å’Œ \(\mathbf{b}\) ä»£è¡¨éœ€è¦è£…èµ°çš„çŸ¿ç‰©çš„åˆ†å¸ƒå’Œéœ€è¦æ¥å—çš„å·¥å‚é‡çš„åˆ†å¸ƒï¼Œåˆ™è½¬è¿æ–¹æ¡ˆçš„è´¹ç”¨æ˜¯ \(\langle\mathbf{f}, \mathbf{a}\rangle+\langle\mathbf{g}, \mathbf{b}\rangle\)</p>

<p>å½“ç„¶ï¼Œè½¬è¿å•†ç»™å‡ºçš„æ–¹æ¡ˆä¸€å®šä¼šä½¿è‡ªå·±ç‰Ÿåˆ©æœ€å¤§ï¼Œå› æ­¤å¯ä»¥çŸ¥é“è½¬è¿å•†çš„æ–¹æ¡ˆçš„æˆæœ¬ä¸‹ç•Œå°±æ˜¯æœ€ä¼˜ä¼ è¾“æ–¹æ¡ˆï¼ŒçŸ¿ä¸»è‡ªå·±éœ€è¦æŠŠè¿è¾“ä»·é’±ç»™å‹ä½ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯ç®—å‡ºåŸé—®é¢˜çš„æœ€ä¼˜ä¼ è¾“ä»£ä»· \(\mathrm{L}_{\mathbf{C}}(\mathbf{a}, \mathbf{b})\)ï¼Œå½“ç„¶å‡ºäºæŸäº›æŠ€æœ¯æ€§é—®é¢˜ï¼Œä»–ä¸èƒ½ç®—å‡ºå…·ä½“çš„æ–¹æ¡ˆï¼Œæ­¤æ—¶æœ‰æ›¿ä»£æ–¹æ¡ˆ :</p>

<p>æ¯”è¾ƒ \(\mathrm{C}_{i, j}\) ä¸ºçŸ¿ä¸»è‡ªå·±è¿ \(i \rightarrow j\) çš„ä»£ä»·ï¼Œè½¬è¿å•†çš„æ–¹æ¡ˆä¸­å¯¹åº”ä¸º \(\mathbf{f}_{i}+\mathbf{g}_{j}\) ï¼Œè‹¥å‡ºç°äº† \(\mathbf{f}_{i}+\mathbf{g}_{j} &gt; \mathrm{C}_{i, j}\) çš„æƒ…å†µï¼Œåˆ™è¿™éƒ¨åˆ†å°±æ˜¯æœ‰å‹ä»·ç©ºé—´çš„</p>

<p>æ¢ä¸€ä¸ªè§’åº¦ï¼Œå·²çŸ¥çŸ¿ä¸»çš„å‹ä»·æ–¹æ¡ˆï¼Œå‡ºäºè½¬è¿å•†çš„è§’åº¦ï¼Œé¦–å…ˆä»–è‡ªå·±ä¸ä¼šç»™å‡ºè¶…è¿‡çŸ¿ä¸»è‡ªå·±è¿è¿˜è´µçš„æ–¹æ¡ˆå»åšè¿™ä»¶äº‹æƒ…ï¼Œå¯¹äºä»»æ„ä¼ è¾“æ–¹æ¡ˆ \(\mathbf{P}\)ï¼Œæœ‰è¾¹é™…åˆ†å¸ƒ \(\mathbf{a},\mathbf{b}\)ï¼Œè‡ªç„¶æœ‰çº¦æŸï¼š</p>

\[\begin{aligned}
\sum_{i, j} \mathbf{P}_{i, j} \mathbf{C}_{i, j} &amp; \geq \sum_{i, j} \mathbf{P}_{i, j}\left(\mathbf{f}_{i}+\mathbf{g}_{j}\right)=\left(\sum_{i} \mathbf{f}_{i} \sum_{j} \mathbf{P}_{i, j}\right)+\left(\sum_{j} \mathbf{g}_{j} \sum_{i} \mathbf{P}_{i, j}\right) \\
&amp;=\langle\mathbf{f}, \mathbf{a}\rangle+\langle\mathbf{g}, \mathbf{b}\rangle
\end{aligned}\]

<p>åŒæ—¶åœ¨æ»¡è¶³è¿™æ ·çš„æ–¹æ¡ˆ \(\mathbf{f},\mathbf{g}\) ä¸­ï¼Œä¸ºäº†ä¸ç»™çŸ¿ä¸»å‹ä»·ç©ºé—´ï¼Œæ»¡è¶³ \(\mathbf{f}_{i}+\mathbf{g}_{j} \leq \mathbf{C}_{i, j}\)ï¼Œå³åº·æ‰˜æ´›ç»´å¥‡å½¢å¼çš„çº¦æŸ \(\mathbf{f} \oplus \mathbf{g} \leq \mathbf{C}\)</p>

<p>ä¸‹å›¾å¯è§†åŒ–çš„å±•ç¤ºäº†åº·æ‰˜æ´›ç»´å¥‡å½¢å¼åŸé—®é¢˜å’Œå¯¹å¶é—®é¢˜çš„å…³ç³»ï¼š</p>

<p style="text-align: center;"><img src="/images/2021-02-02-Computational-Optimal-Transport-Note-Part-1/Primal_Dual.png" alt="Primal_Dual" style="zoom:40%;" /></p>

<p>è¿›ä¸€æ­¥çš„ï¼Œå¯¹å¶é—®é¢˜ä¹Ÿå¯ä»¥æ¨å¹¿åˆ°ä»»æ„çš„æµ‹åº¦ä¸Šï¼š</p>

\[\mathcal{L}_{c}(\alpha, \beta)=\sup _{(f, g) \in \mathcal{R}(c)} \int_{\mathcal{X}} f(x) \mathrm{d} \alpha(x)+\int_{\mathcal{Y}} g(y) \mathrm{d} \beta(y)
\\
\mathcal{R}(c) \stackrel{\text { def. }}{=}\{(f, g) \in \mathcal{C}(\mathcal{X}) \times \mathcal{C}(\mathcal{Y}): \forall(x, y), f(x)+g(y) \leq c(x, y)\}\]

<p>åŒæ—¶ä¾ç„¶æœ‰æœ€ä¼˜ä¼ è¾“çš„æ”¯æ’‘é›†åœ¨å¯¹å¶é—®é¢˜å¯è¡Œé›†å’ŒåŸé—®é¢˜å¯è¡Œé›†ä¸­äº¤é›†ä¸­ï¼š</p>

\[\operatorname{Supp}(\pi) \subset\{(x, y) \in \mathcal{X} \times \mathcal{Y}: f(x)+g(y)=c(x, y)\}\]

<p>ä¸Šé¢çš„æœ‰çº¦æŸæƒ…å†µï¼Œåœ¨ \(\alpha,\beta\) æ„æˆåˆ†å¸ƒï¼Œå³ï¼š\(\int_{\mathcal{X}} \mathrm{d} \alpha=\int_{\mathcal{Y}} \mathrm{d} \beta=1\)ï¼Œå¯ä»¥è½¬åŒ–æˆæ— çº¦æŸå½¢å¼ï¼š</p>

\[\mathcal{L}_{c}(\alpha, \beta)=\sup _{(f, g) \in \mathcal{C}(\mathcal{X}) \times \mathcal{C}(\mathcal{Y})} \int_{\mathcal{X}} f \mathrm{~d} \alpha+\int_{\mathcal{Y}} g \mathrm{~d} \beta+\min _{\mathcal{X} \otimes \mathcal{Y}}(c-f \oplus g)\]

<h2 id="brenier-theorem">Brenier Theorem</h2>

<p>åº·æ‰˜æ´›ç»´å¥‡å½¢å¼å’Œè’™æ—¥å½¢å¼ç­‰ä»·æ€§æ˜¯éå¸¸é‡è¦çš„ï¼Œè‡³å°‘åˆ°ç°åœ¨ï¼Œè¯æ˜å…¶ç­‰ä»·æ€§éœ€è¦è¯æ˜åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè’™æ—¥å½¢å¼ç»™å‡ºäº†åº·æ‰˜æ´›ç»´å¥‡å½¢å¼çš„ä¸€ä¸ªä¸‹ç•Œï¼Œè¿™å…¶å®å¾ˆéš¾åšåˆ°ã€‚Brenier Theorem ç»™å‡ºæ¡ä»¶ï¼šåœ¨ \(R^{d}\) ä¸­ï¼Œä¼ è¾“è·ç¦»å®šä¹‰ä¸º \(p=2\) çš„æƒ…å†µï¼Œä¸¤ä¸ªæµ‹åº¦ä¸­è‡³å°‘æµ‹åº¦ \(\alpha\) æœ‰ä¸€ä¸ªèƒ½å®šä¹‰ \(\rho_{\alpha}\)ï¼Œä¸”æœ‰äºŒé˜¶çŸ©ï¼Œåˆ™åœ¨è¿™æ ·çš„æ¡ä»¶ä¸‹ï¼Œåº·æ‰˜æ´›ç»´å¥‡å½¢å¼å’Œè’™æ—¥å½¢å¼æ˜¯ç­‰ä»·çš„</p>

<p>å…·ä½“ä¸€äº›çš„è¯ï¼Œåœ¨ \(\mathcal{X}=\mathcal{Y}=\mathbb{R}^{d}\) ä¸­æœ‰ä»£ä»·å‡½æ•° \(c(x, y)=\|x-y\|^{2}\)ï¼Œå…¶ä¸­è‡³å°‘ä¸€ä¸ªæµ‹åº¦ \(\alpha\) æœ‰ä¸€ä¸ªèƒ½å®šä¹‰ \(\rho_{\alpha}\)ï¼Œä¸”æœ‰äºŒé˜¶çŸ© åº·æ‰˜æ´›ç»´å¥‡æœ€ä¼˜ä¼ è¾“æ˜¯å”¯ä¸€çš„ï¼Œä¸”å…¶æ”¯æ’‘é›†å’Œè’™æ—¥ä¼ è¾“çš„æ”¯æ’‘é›†æ˜¯ä¸€æ ·çš„ï¼Œä¸º \(\{(x, T(x)), T: \mathbb{R}^{d} \rightarrow \mathbb{R}^{d} \}\)ï¼Œè€Œåº·æ‰˜æ´›ç»´å¥‡ä¼ è¾“è®¡åˆ’å¯ä»¥è¡¨ç¤ºä¸º \(\pi=(\mathrm{Id}, T)_{\#}\alpha\)ï¼Œæ¯”å¦‚ï¼š
\(\forall h \in \mathcal{C}(\mathcal{X} \times \mathcal{Y}), \quad \int_{\mathcal{X} \times \mathcal{Y}} h(x, y) \mathrm{d} \pi(x, y)=\int_{\mathcal{X}} h(x, T(x)) \mathrm{d} \alpha(x)\)
è¿›ä¸€æ­¥çš„ï¼Œè¿˜å¯ä»¥ç»™å‡ºè’™æ—¥ä¼ è¾“æ˜ å°„ \(T\) çš„å½¢å¼ï¼Œé€šè¿‡ä¸€ä¸ªå‡¸å‡½æ•° \(\varphi(x)\) å®šä¹‰ï¼Œä¸ºå…¶æ¢¯åº¦ \(T(x)=\nabla \varphi(x)\)ï¼Œè€Œ \(\varphi(x)\) ç”±ä¹‹å‰åº·æ‰˜æ´›ç»´å¥‡å¯¹å¶å½¢å¼ä¸­çš„ \(f\) ç»™å‡ºï¼š\(\varphi(x)=\frac{\|x\|^{2}}{2}-f(x)\) ã€‚ç®€è¦çš„è¯æ˜æ˜¯é€šè¿‡ï¼š</p>

<p>åº·æ‰˜æ´›ç»´å¥‡ä¼ è¾“ä»£ä»·æœ‰ç­‰ä»·å½¢å¼ï¼š\(\int c \mathrm{~d} \pi=C_{\alpha, \beta}-2 \int\langle x, y\rangle \mathrm{d} \pi(x, y)\)ï¼Œè€Œç”±äºæµ‹åº¦ \(\alpha,\beta\) å·²çŸ¥ï¼Œ\(C_{\alpha, \beta}=\int\|x\|^{2} \mathrm{~d} \alpha(x)+\int\|y\|^{2} \mathrm{~d} \beta(y)\) è¿™éƒ¨åˆ†ä¸ºå¸¸æ•°ï¼Œé—®é¢˜å°±ç­‰ä»·äºå»æ±‚è§£ï¼š
\(\max _{\pi \in \mathcal{U}(\alpha, \beta)} \int_{\mathcal{X} \times \mathcal{Y}}\langle x, y\rangle \mathrm{d} \pi(x, y)\)
åˆ©ç”¨å¯¹å¶æ€§å¯ä»¥å†™å‡ºï¼š
\(\min _{(\varphi, \psi)}\left\{\int_{\mathcal{X}} \varphi \mathrm{d} \alpha+\int_{\mathcal{Y}} \psi \mathrm{d} \beta: \forall(x, y), \quad \varphi(x)+\psi(y) \geq\langle x, y\rangle\right\}\)
å¯ä»¥çŸ¥é“ \((\varphi, \psi)\) å’Œ \((f, g)\) çš„å…³ç³»æ»¡è¶³</p>
:ET