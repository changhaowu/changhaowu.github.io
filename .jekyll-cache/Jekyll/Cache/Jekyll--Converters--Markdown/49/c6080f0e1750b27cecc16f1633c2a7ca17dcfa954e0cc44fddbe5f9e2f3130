I"õt<h1 id="optimal-transport-note-part-1">Optimal Transport Note: Part 1</h1>

<h2 id="formulation-of-optimal-transport">Formulation of Optimal Transport</h2>

<h3 id="monge-formulation">Monge Formulation</h3>

<p>æœ€ä¼˜ä¼ è¾“çš„èƒŒæ™¯æ˜¯è’™æ—¥è€ƒè™‘åœ¨å»ºé€ é˜²å¾¡å·¥äº‹æ—¶ï¼Œå¦‚ä½•èŠ±è´¹æœ€å°‘çš„åŠ³åŠ¨åŠ›å»æŠŠå››æ•£çš„åœŸå †è¿è¾“åˆ°å…¶ä»–å¤„çš„é˜²å¾¡å·¥äº‹å¤„ï¼Œåœ¨æ­¤ä¹‹ä¸ŠæŠ½è±¡å‡ºäº†æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼Œæœ€ä¼˜ä¼ è¾“é—®é¢˜æ€»å…±æœ‰ä¸¤ç§ææ³•ï¼Œè’™æ—¥å½¢å¼ï¼ˆMonge Formulationï¼‰å’Œåº·æ‰˜æ´›ç»´å¥‡å½¢å¼ï¼ˆKantorovich Formulationï¼‰ï¼Œåº·æ‰˜æ´›ç»´å¥‡å½¢å¼æ›´åŠ å®Œå–„ï¼Œæ›´åŠ é€‚åˆç†è®ºç ”ç©¶ï¼Œè’™æ—¥å½¢å¼åˆ™æ›´åŠ é€‚åˆåº”ç”¨ä¸Šçš„è®¡ç®—ã€‚</p>

<p>å…ˆç»™å‡ºè’™æ—¥å½¢å¼çš„æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼š</p>

<p>æœ‰æ¦‚ç‡ç©ºé—´ \((X, \Sigma_X , \mu)\) å’Œ \((Y, \Sigma_Y , \nu)\)</p>

<p>å®šä¹‰ä»£ä»·å‡½æ•° \(c: X \times Y \rightarrow[0,+\infty]\)ï¼Œæµ‹é‡è¿è¾“ \(x \in X\) åˆ° \(y \in Y\) çš„ä»£ä»·</p>

<p>å®šä¹‰ä¼ è¾“æ˜ å°„ \(T: X \rightarrow Y\) å°† \(u \in \mathcal{P}(X)\) ä¼ è¾“åˆ° \(\nu \in \mathcal{P}(Y)\)ï¼Œå½“</p>

\[\nu(B)=\mu\left(T^{-1}(B)\right) \quad  \forall \; \nu \text { -measurable } B\]

<p>è¿™æ ·å®šä¹‰ä¿è¯äº†ä¼ è¾“æ˜ å°„å¿…é¡»åŒå°„ï¼Œè€Œæµ‹åº¦ä¸å˜ï¼Œç›´è§‚ä¸Šæ¥è¯´ï¼Œå°±æ˜¯ä¼ è¾“æ˜ å°„ \(T\)ï¼Œä» \(X\) ä¸­å–èµ°å¤šå°‘åœŸï¼Œå°±ç›¸åº”æœ‰å¤šå°‘åœŸè¿åˆ° \(Y\) ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>

<p style="text-align: center;"><img src="/images/2021-01-20-Optimal-Transport-Note-Part-1/Visualing_Transport_Map.png" alt="Visualing_Transport_Map" style="zoom:30%;" /></p>

<p>åœ¨ä¸Šé¢çš„å®šä¹‰ä¸‹ï¼Œç§° \(T\) ä¼ è¾“ \(\mu\) åˆ° \(\nu\) ï¼Œè®° \(\nu=T_{\#} \mu\)</p>

<p>ç„¶åå¯¹äºä¼ è¾“æ˜ å°„å°±æœ‰ä¸¤æ¡æ€§è´¨ï¼š</p>

<p>å¯¹äº \(\mu \in \mathcal{P}(X), T: X \rightarrow Y, S: Y \rightarrow Z\)ï¼Œä»¥åŠ \(f \in L^{1}(Y)\)</p>

<ol>
  <li>
    <p>å˜é‡å˜æ¢å…¬å¼ï¼šåˆ†åˆ«åœ¨åŸåƒé›†å’Œåƒé›†çš„è§’åº¦ä¸‹ï¼Œï¼ˆ\(f \equiv 1\) åˆ™ä¸ºä¸Šé¢çš„è´¨é‡ä¸å˜ï¼Œæ¨å¹¿è´¨é‡ä¸å˜åˆ°æœŸæœ›ä¸å˜ï¼Ÿï¼‰</p>

\[\int_{Y} f(y) \mathrm{d}\left(T_{\#} \mu\right)(y)=\int_{X} f(T(x)) \mathrm{d} \mu(x)\]
  </li>
  <li>
    <p>æ˜ å°„å¤åˆå…¬å¼ï¼šæ¨å¹¿åˆ°å­˜åœ¨ä¸­è½¬ç«™è¿™æ ·çš„æƒ…å†µä¸‹è€Œå®šä¹‰</p>

\[(S \circ T)_{\#} \mu=S_{\#}\left(T_{\#} \mu\right)\]
  </li>
</ol>

<p>ä¸Šé¢çš„å®šä¹‰éƒ½å¾ˆè‡ªç„¶åˆä¸¥è°¨ï¼Œä½†æ˜¯å¾ˆå¯æƒœï¼Œç”±äºè’™æ—¥å½¢å¼ä¸‹è¦æ±‚ä¼ è¾“æ˜ å°„ \(T\) å¯é€†ï¼Œå…¶ä¸ä¸€å®šå­˜åœ¨</p>

<p>æ¯”å¦‚åœ¨ \(x_{1}\) å¤„æœ‰ \(1\) å•ä½æ²™å †ï¼Œè€Œåœ¨ \(y_{1},y_{2}\) å¤„åˆ†åˆ«æœ‰ä¸¤ä¸ª \(\frac{1}{2}\) å•ä½çš„é˜²å¾¡å·¥äº‹è¦å»ºé€ </p>

<p>æ¢è¨€ä¹‹ \(\mu=\delta_{x_{1}}\) è€Œ \(\nu=\frac{1}{2} \delta_{y_{1}}+\frac{1}{2} \delta_{y_{2}}\) ï¼Œç”±äº\(\nu\left(\left\{y_{1}\right\}\right)=\frac{1}{2}\)ï¼Œå…¶ä¸å¯èƒ½ç­‰äº \(\mu\left(T^{-1}\left(y_{1}\right)\right) \in\{0,1\}\)ï¼Œå› æ­¤ä¼ è¾“æ˜ å°„ \(T\) ä¸å­˜åœ¨</p>

<p>äºæ˜¯å°±å¯ä»¥å®šä¹‰è’™æ—¥å½¢å¼çš„æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼š\(T: X \rightarrow Y \text { subject to } \nu=T_{\#} \mu\)</p>

\[\text { minimise } \mathbb{M}(T)=\int_{X} c(x, T(x)) \mathrm{d} \mu(x)\]

<h3 id="kantorovich-formulation">Kantorovich Formulation</h3>

<p>ç”±äºè’™æ—¥å½¢å¼ä¸‹ï¼Œå®šä¹‰çš„æœ€ä¼˜ä¼ è¾“ \(x \mapsto T(x)\) ï¼Œç”±äºä¼ è¾“æ˜ å°„éœ€è¦ä¿è¯æ˜ å°„çš„ç‰¹æ€§ï¼Œæˆ–è€…ç›´è§‚ä¸Šæ¥è¯´ï¼Œ \(x_{1}\) å¤„çš„åœŸå †ä¸èƒ½åˆ†å‰²ï¼Œåªèƒ½å…¨éƒ¨ä¼ è¾“åˆ°å¦ä¸€ä¸ªç‚¹ \(y_{1}\) å¤„ï¼Œéœ€è¦æ›´åŠ çµæ´»çš„å®šä¹‰</p>

<p>å› æ­¤åº·æ‰˜æ´›ç»´å¥‡å®šä¹‰äº†ä¼ è¾“è®¡åˆ’ \(\pi \in \mathcal{P}(X \times Y)\) ï¼Œä¼ è¾“è®¡åˆ’ä¸€æ ·è¦æœä»ä¼ è¾“è´¨é‡ä¸å˜æ€§çš„çº¦æŸï¼Œä½†åœ¨æ­¤ä¹‹ä¸Šï¼Œä¼ è¾“è®¡åˆ’ä½¿å¾— \(x_{1}\) å¤„çš„åœŸå †å¯ä»¥è¿è¾“åˆ°å¤šä¸ªç›®çš„åœ° \(\{y_{1},...,y_{n}\}\) å¤„ï¼Œåªéœ€è¦æ»¡è¶³ \(\mu({x_1})=\nu(\{y_{1},...,y_{n}\})\) å³å¯</p>

<p>æˆ–è€…è€ƒè™‘è”åˆåˆ†å¸ƒå’Œè¾¹é™…åˆ†å¸ƒçš„æ¦‚å¿µï¼Œåœ¨æ¦‚ç‡ç©ºé—´ \((X, \Sigma_X , \mu)\) å’Œ \((Y, \Sigma_Y , \nu)\) çš„åŸºç¡€ä¸Šï¼Œæœ‰\(\pi \in \mathcal{P}(X \times Y)\) ï¼Œè®° \(\mathrm{d} \pi(x, y)\) æ˜¯ä» \(x\) ä¼ è¾“åˆ° \(y\) çš„è´¨é‡ï¼Œæœä»</p>

\[\pi(A \times Y)=\int_{A \times Y} d\pi\left(x,y\right)=\mu(A) \quad \pi(X \times B)=\int_{X \times B} d\pi\left(x,y\right)=\nu(B)\]

<p>è®° \(\Pi(\mu, \nu)\) ä¸ºä¼ è¾“æ–¹æ¡ˆçš„é›†åˆï¼Œæ¯”èµ·ä¼ è¾“æ˜ å°„ \(T\) å¯èƒ½ä¸å­˜åœ¨çš„é—®é¢˜ï¼Œä¼ è¾“è®¡åˆ’ \(\Pi(\mu, \nu)\) æ°¸è¿œéç©ºï¼Œå› ä¸ºæœ‰ä¸€ä¸ªå¹³å‡¡è§£ \(\pi^{*}\) ,å–å®š \(\{y^*\} \in \Sigma_{Y}\) ï¼Œå¯¹åº”çš„ \(X\) ä¸Šçš„èµ·ç‚¹åœ¨æ»¡è¶³çº¦æŸ \(\int_{X } d\pi\left(x,y^*\right)=\nu(y^*)\) å¯¹ \(\nu(y^*)\) æˆæ¯”ä¾‹å–å€¼å³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>

<p style="text-align: center;"><img src="/images/2021-01-20-Optimal-Transport-Note-Part-1/Trivial_Plan.png" alt="Trivial Pan" style="zoom:40%;" /></p>

<p>å®šä¹‰å¥½äº†ä¼ è¾“è®¡åˆ’åï¼Œå°±å¯ä»¥å®šä¹‰åº·æ‰˜æ´›ç»´å¥‡å½¢å¼çš„æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼š\(\mu \in \mathcal{P}(X) ,\nu \in \mathcal{P}(Y)\)</p>

\[\text { minimise } \mathbb{K}(\pi)=\int_{\mathrm{X} \times Y} c(x, y) \mathrm{d} \pi(x, y) 
\quad
\text{subject to} \quad \pi \in \Pi(\mu, \nu)\]

<p>ä¸‹é¢è¯æ˜è’™æ—¥å½¢å¼ä¸åº·æ‰˜æ´›ç»´å¥‡å½¢å¼çš„å…³ç³»ï¼šå‡è®¾è’™æ—¥å½¢å¼æœ€ä¼˜å­˜åœ¨ï¼Œ\(T^{\dagger}: X \rightarrow Y\)ï¼Œå®šä¹‰ \(d \pi(x, y)=\mathrm{d} \mu(x) \delta_{y=T^{\dagger}(x)}\)</p>

\[\begin{array}{l}
\pi(A \times Y)=\int_{A} \delta_{T^{\dagger}(x) \in Y} \mathrm{~d} \mu(x)=\mu(A) \\
\pi(X \times B)=\int_{X} \delta_{T^{\dagger}(x) \in B} \mathrm{~d} \mu(x)=\mu\left(\left(T^{\dagger}\right)^{-1}(B)\right)=T_{\#}^{\dagger} \mu(B)=\nu(B)
\end{array}\]

<p>äºæ˜¯ \(\pi \in \Pi(\mu, \nu)\) ï¼Œ</p>

\[\int_{X \times Y} c(x, y) \mathrm{d} \pi(x, y)=\int_{X} \int_{Y} c(x, y) \delta_{y=T^{\dagger}(x)} \mathrm{d} y \mathrm{~d} \mu(x)=\int_{X} c\left(x, T^{\dagger}(x)\right) \mathrm{d} \mu(x)\]

<p>äºæ˜¯æœ‰</p>

\[\inf \mathbb{K}(\pi) \leq \inf \mathbb{M}(T)\]

<p>è€Œå½“ä¼ è¾“è®¡åˆ’ä¸ä¼ è¾“æ˜ å°„ç­‰ä»·çš„æ—¶å€™ï¼Œå³ \(d \pi^{\dagger}(x, y)=\mathrm{d} \mu(x) \delta_{y=T^{\dagger}(x)}\) æ—¶ï¼Œæ­¤æ—¶æœ‰ \(\inf \mathbb{K}(\pi) = \inf \mathbb{M}(T)\) ï¼Œæ­¤æ—¶è’™æ—¥å½¢å¼ä¸åº·æ‰˜æ´›ç»´å¥‡å½¢å¼æ˜¯ç­‰ä»·çš„</p>

<p>æœ€ä¼˜ä¼ è¾“çš„ä¸€ä¸ªåº”ç”¨æ˜¯ï¼Œåˆ©ç”¨æœ€ä¼˜ä¼ è¾“çš„æ’å€¼ï¼š</p>

\[\begin{aligned}
\mu_{t}&amp;=\left((1-t) \mathrm{Id}+t T^{\dagger}\right)_{\#} \mu
\\
\mu_{0}(B)&amp;=\left(\mathrm{Id}\right)_{\#} \mu(B)=\mu(\mathrm{Id}^{-1}(B))=\mu(B) 
\\
\mu_{1}(B)&amp;=\mu_{1}\left(T^{\dagger-1}(B)\right)=\nu(B)
\end{aligned}\]

<p>å…¶æ•ˆæœä¼šæ¯”å•çº¯çš„åœ¨æ¬§æ°ç©ºé—´ä¸­æ’å€¼ï¼š</p>

\[\mu_{t}^{E}=(1-t) \mu+t \nu\]

<p>åœ¨å¯è§†åŒ–åçš„æ•ˆæœä¸Šæ›´å¥½ä¸€äº›ï¼š</p>

<p style="text-align: center;"><img src="/images/2021-01-20-Optimal-Transport-Note-Part-1/OT_interpolation.png" alt="OT_interpolation" style="zoom:40%;" /></p>

<h2 id="special-cases">Special Cases</h2>

<p>ä¸€èˆ¬æ„ä¹‰ä¸‹çš„æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼Œè¿˜éœ€è¦åº·æ‰˜æ´›ç»´å¥‡å¯¹å¶æ€§ç­‰å·¥å…·ï¼Œä½†æ˜¯åœ¨æ­¤ä¹‹å‰ï¼Œæœ‰ä¸¤ç§ç‰¹æ®Šçš„æƒ…å†µï¼Œä¸ç”¨å¯¹å¶æ€§å°±å¯ä»¥è§£å†³ï¼Œäºæ˜¯å…ˆæ‘˜äº†è¿™äº›â€œä½å‚çš„æœå®â€ X:)</p>

<h3 id="optimal-transport-in-one-dimension">Optimal Transport in One Dimension</h3>

<p>åœ¨ä¸€ç»´æƒ…å†µä¸‹ï¼Œæœ‰æ¦‚ç‡ç©ºé—´ \((X, \Sigma_X , \mu)\) å’Œ \((Y, \Sigma_Y , \nu)\) ä¸‹ï¼Œè¿›è€Œåˆ©ç”¨ \(\mu,\nu\)  å¯ä»¥å®šä¹‰å³è¿ç»­ï¼Œä¸å‡çš„ \(c.d.f\) \(F(x),G(y)\) ï¼Œæœ‰æ€§è´¨ï¼š</p>

\[F(x)=\int_{-\infty}^{x} \mathrm{~d} \mu=\mu((-\infty, x])
\\
F(-\infty)=0 \quad F(+\infty)=1
\\\]

<p>åŒæ—¶ï¼Œå¯ä»¥å®šä¹‰å¹¿ä¹‰é€† \(F^{-1}\)</p>

\[F^{-1}(t)=\inf \{x \in \mathbb{R}: F(x)&gt;t\}
\\
F^{-1}(F(x)) \geq x \quad F\left(F^{-1}(t)\right) \geq t\]

<p>è¿›ä¸€æ­¥å½“ \(F\) å¯é€†æ—¶</p>

\[F^{-1}(F(x))=x \quad F\left(F^{-1}(t)\right)=t\]

<p>ä»¥ä¸Šçš„å®šä¹‰ï¼Œå¯¹äº \(\nu\) æ¥è¯´ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„å†åšä¸€é</p>

<p>ç„¶åå°±æœ‰äº† Theorem 2.1</p>

<h4 id="theorem--21">Theorem  2.1</h4>

<p>\(\mu, \nu \in \mathcal{P}(\mathbb{R})\) å…¶ \(c.d.f\) åˆ†åˆ«æ˜¯ \(F,G\)ï¼Œ è®¤ä¸º \(c(x, y)=d(x-y)\) æ˜¯å‡¸çš„ä¸”è¿ç»­çš„ï¼Œ\(\pi^{\dagger} \in  \mathcal{P}(\mathbb{R}^{2})\) ä¸”æœ‰ \(c.d.f \quad H(x, y)=\min \{F(x), G(y)\}\) ï¼Œåˆ™ \(\pi^{\dagger} \in \Pi(\mu, \nu)\) ä¸” \(\pi^{\dagger}\) æ˜¯åº·æ‰˜æ´›ç»´å¥‡å½¢å¼æœ€ä¼˜ä¼ è¾“é—®é¢˜çš„è§£ï¼Œä¸”åœ¨ä»£ä»·å‡½æ•° \(c(x,y)\) ä¸‹çš„ä¼ è¾“ä»£ä»·ä¸º</p>

\[\min _{\pi \in \Pi(\mu, \nu)} \mathbb{K}(\pi)=\int_{0}^{1} d\left(F^{-1}(t)-G^{-1}(t)\right) \mathrm{d} t\]

<h4 id="corollary-22">Corollary 2.2</h4>

<ol>
  <li>
    <p>å½“ \(c(x, y)=   \lvert x-y  \rvert\) ï¼Œåˆ™æœ€ä¼˜ä¼ è¾“ä»£ä»·ä¹Ÿç­‰äºä¸¤ä¸ª \(c.d.f\) çš„ \(L^1\) è·ç¦»ï¼š</p>

\[\inf _{\pi \in \Pi(\mu, \nu)} \mathbb{K}(\pi)=\int_{\mathbb{R}}|F(x)-G(x)| \mathrm{d}\]

    <p style="text-align: center;"><img src="/images/2021-01-20-Optimal-Transport-Note-Part-1/abs_cost_equalivence.png" alt="abs_cost_equalivence" style="zoom:40%;" /></p>

    <p>å¦‚å›¾æ‰€ç¤ºï¼Œæè¿°ç§¯åˆ†åŒºåŸŸå¯ä»¥ç”¨ä¸¤ç§æ–¹æ³•ï¼š</p>

\[\begin{aligned}
\mathcal{A} &amp;=\left\{(x, t): \min \left\{F^{-1}(t), G^{-1}(t)\right\} \leq x \leq \max \left\{F^{-1}(t), G^{-1}(t)\right\}, t \in[0,1]\right\} \\ 
&amp;= \{(x, t): \min \{F(x), G(x)\} \leq t \leq \max \{F(x), G(x)\}, x \in \mathbb{R}\}
\end{aligned}\]

    <p>ä¸” \(\max \{a, b\}-\min \{a, b\}= \lvert a-b  \rvert\) å³ä¸ºä»£ä»·å‡½æ•°å³å¯è¯æ˜</p>
  </li>
  <li>
    <p>è‹¥ä¼ è¾“è®¡åˆ’ç­‰ä»·äºä¼ è¾“æ˜ å°„ \(\min _{\pi \in \Pi(\mu, \nu)} \mathbb{K}(\pi)=\min _{T: T_{\#} \mu=\nu} \mathbb{M}(T)\) ï¼Œåˆ™ \(T^{\dagger}=G^{-1} \circ F\) æ˜¯è’™æ—¥å½¢å¼çš„æœ€ä¼˜ä¼ è¾“æ˜ å°„ï¼š</p>

\[\inf _{T: T_{\#} \mu=\nu} \mathbb{M }(T)=\mathbb{M}\left(T^{\dagger}\right)\]

    <ol>
      <li>
        <p>ç¬¬ä¸€éƒ¨åˆ†è¯æ˜ \(T^{\dagger}_{\#} \mu=\nu\) ï¼š</p>

        <p>åˆ©ç”¨ä¹‹å‰çš„å¤åˆæ˜ å°„å…¬å¼ï¼ŒçŸ¥\(T^{\dagger}_{\#} \mu =G_{\#}^{-1}\left(F_{\#} \mu\right)\) ï¼Œç”±äº \(F\) è¿ç»­ ï¼Œ\(\exists x_t,\forall t \in (0,1)  ,F\left(x_{t}\right)=t\)  ï¼Œäºæ˜¯å¯¹äº \(F_{\#} \mu\) æœ‰ï¼š</p>

\[\begin{aligned}
F_{\#} \mu([0, t]) &amp;=\mu(\{x: F(x) \leq t\}) \\
&amp;=\mu\left(\left\{x: x \leq x_{t}\right\}\right) \\
&amp;=F\left(x_{t}\right) \\
&amp;=t
\\
&amp;\Rightarrow F_{\#} \mu=\mathcal{L}_{[0,1]}
\end{aligned}\]

        <p>äºæ˜¯é—®é¢˜å˜æˆè¯æ˜ \(T^{\dagger}_{\#} \mu =G_{\#}^{-1}\left(\mathcal{L}_{[0,1]}\right)\)</p>

\[\begin{aligned}
G_{\#}^{-1} \mathcal{L}\left\lfloor_{[0,1]}((-\infty, y])\right.&amp;=\mathcal{L}\left\lfloor_{[0,1]}\left(\left\{t: G^{-1}(t) \leq y\right\}\right)\right.\\
&amp;=\mathcal{L}\left\lfloor_{[0,1]}(\{t: G(y) \geq t\})\right.\\
&amp;=G(y) \\
&amp;=\nu((-\infty, y])
\\
&amp;\Rightarrow T^{\dagger}_{\#} \mu =G_{\#}^{-1}\left(F_{\#} \mu\right)
\end{aligned}\]
      </li>
      <li>
        <p>ç¬¬äºŒéƒ¨åˆ†è¯æ˜ \(T^{\dagger}\) æ˜¯è’™æ—¥å½¢å¼çš„æœ€ä¼˜ä¼ è¾“ï¼Œåˆ©ç”¨ä¹‹å‰çš„è´¨é‡ä¸å˜å…¬å¼å’Œ \(F_{\#} \mu=\mathcal{L}_{[0,1]}\)</p>

\[\begin{aligned}
\inf _{\pi \in \Pi(\mu, \nu)} \mathbb{K}(\pi) &amp;=\int_{0}^{1} d\left(F^{-1}(t)-G^{-1}(t)\right) \mathrm{d} t \\
&amp;=\int_{\mathbb{R}} d\left(x-G^{-1}(F(x))\right) \mathrm{d} \mu(x) \\
&amp;=\int_{\mathbb{R}} d\left(x-T^{\dagger}(x)\right) \mathrm{d} \mu(x) \\
&amp; \geq \inf _{T: T_{\#} \mu=\nu} \mathbb{M}(T)
\end{aligned}\]

        <p>åŒæ—¶ \(\inf _{T: T_{\#} \mu=\nu} \mathbb{M}(T) \geq \min _{\pi \in \Pi(\mu, \nu)} \mathbb{K}(\pi)\) ï¼Œå› æ­¤  \(T^{\dagger}=G^{-1} \circ F\) æ˜¯è’™æ—¥æœ€ä¼˜ä¼ è¾“</p>
      </li>
    </ol>
  </li>
</ol>

<h4 id="proposition-23">Proposition 2.3</h4>

<p>å®šä¹‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ€§è´¨ï¼Œé›†åˆçš„å•è°ƒæ€§ï¼ˆè¿™æ˜¯å¯¹äºæŸä¸ªæµ‹åº¦ \(d\) ï¼‰ï¼Œç”±ç®€å•çš„ä¸€ä¸ªäºŒç»´æƒ…å†µåšä¾‹å­ï¼š</p>

<p>å¯¹äº \(\Gamma \subset \mathbb{R}^{2}\)ï¼Œ\(\forall \left(x_{1}, y_{1}\right),\left(x_{2}, y_{2}\right) \in \Gamma\) , \(\Gamma\) æ˜¯å•è°ƒçš„å½“ï¼š</p>

\[d\left(x_{1}-y_{1}\right)+d\left(x_{2}-y_{2}\right) \leq d\left(x_{1}-y_{2}\right)+d\left(x_{2}-y_{1}\right)\]

<p>ç„¶åæ˜¯ Proposition 2.3 çš„å†…å®¹ï¼š</p>

<p>æœ‰ \(\mu, \nu \in \mathcal{P}(\mathbb{R})\)ï¼Œå‡è®¾åœ¨ä»£ä»·å‡½æ•° \(c(x, y)=d(x-y)\) æ„ä¹‰ä¸‹çš„æœ€ä¼˜ä¼ è¾“è®¡åˆ’ \(\pi^{\dagger} \in \Pi(\mu, \nu)\)ï¼Œå¯¹äºä»»ä½•æ”¯æ’‘é›†ä¸­çš„ç‚¹ \(\left(x_{1}, y_{1}\right),\left(x_{2}, y_{2}\right) \in \operatorname{supp}\left(\pi^{\dagger}\right)\)ï¼Œæœ‰</p>

\[d\left(x_{1}-y_{1}\right)+d\left(x_{2}-y_{2}\right) \leq d\left(x_{1}-y_{2}\right)+d\left(x_{2}-y_{1}\right)\]

<p>åˆ©ç”¨åè¯æ³•è¯æ˜ï¼Œè‹¥èƒ½åœ¨æ”¯æ’‘é›†ä¸­æ„é€ ä¸€ä¸ª \(\pi^{\dagger}\) çš„ä¸‹ç•Œ \(\pi^{*}\) ï¼Œä¸”è¯æ˜ \(\pi^{*}  \in \Pi(\mu, \nu)\)</p>

<p>å‡è®¾åœ¨æ”¯æ’‘é›†ä¸­å­˜åœ¨ä¸å•è°ƒçš„ç‚¹ \(\left(x_{1}, y_{1}\right),\left(x_{2}, y_{2}\right) \in \operatorname{supp}\left(\pi^{\dagger}\right)\)ï¼Œé‚£ä¹ˆå°±æœ‰ï¼š</p>

\[d\left(x_{1}-y_{1}\right)+d\left(x_{2}-y_{2}\right)-d\left(x_{1}-y_{2}\right)-d\left(x_{2}-y_{1}\right) \geq \eta\]

<p>ç„¶ååœ¨ \((X, \Sigma_X , \mu)\) å’Œ \((Y, \Sigma_Y , \nu)\) ä¸Šåˆ†åˆ«æ„é€ ä¸¤ä¸ªé—­åŒºé—´ \(I_{1}, I_{2}, J_{1}, J_{2}\)ï¼Œä¸”æ»¡è¶³ï¼š</p>

<ol>
  <li>
\[x_{i} \in I_{i}, y_{i} \in J_{i}, i=1,2\]
  </li>
  <li>\(\forall x \in I_{i}, y \in J_{j}, i, j=1,2,d(x-y) \geq d\left(x_{i}-y_{j}\right)-\varepsilon\) ï¼Œä¸” \(\varepsilon&lt;\frac{\eta}{4}\)</li>
  <li>$I_{i} \times J_{j}$ ä¸ç›¸äº¤;</li>
  <li>$\pi^{\dagger}\left(I_{1} \times J_{1}\right)=\pi^{\dagger}\left(I_{2} \times J_{2}\right)=\delta&gt;0$</li>
</ol>

<p>è¿™æ ·çš„é—­åŒºé—´å¯ä»¥é€šè¿‡å–çš„å¾ˆå°æ„é€ å‡ºï¼Œåˆ©ç”¨è¿™äº›å°åŒºé—´å»æ„é€ æ¯” \(\pi^{\dagger}\) å°çš„æµ‹åº¦ \(\tilde{\pi}\)ï¼Œè€Œåœ¨å°åŒºé—´ä¹‹å¤–çš„éƒ¨åˆ†ï¼Œåˆ™åˆ©ç”¨åŸå…ˆçš„æœ€ä¼˜ä¼ è¾“ \(\pi^{\dagger}\) ï¼Œå› æ­¤è¿˜éœ€è¦å®šä¹‰ \(\pi^{\dagger}\) çš„æŠ•å½±ï¼š</p>

\[\begin{array}{ll}
\tilde{\mu}_{1}=P_{\#}^{X} \pi^{\dagger}\left\lfloor I_{1} \times J_{1},\right. &amp; \tilde{\mu}_{2}=P_{\#}^{X} \pi^{\dagger}\left\lfloor I_{2} \times J_{2}\right. \\
\tilde{\nu}_{1}=P_{\#}^{Y} \pi^{\dagger}\left\lfloor_{I_{1} \times J_{1}},\right. &amp; \tilde{\nu}_{2}=P_{\#}^{Y} \pi^{\dagger}\left\lfloor I_{2} \times J_{2}\right.
\end{array}\]

<p>äºæ˜¯åˆ©ç”¨æœ€ä¼˜ä¼ è¾“æŠ•å½± \(\pi^{\dagger}\) çš„æµ‹åº¦ï¼Œæ„é€  \(\tilde{\pi}_{12} \in \Pi\left(\tilde{\mu}_{1}, \tilde{\nu}_{2}\right), \tilde{\pi}_{21} \in \Pi\left(\tilde{\mu}_{2}, \tilde{\nu}_{1}\right)\)ï¼Œå¹¶å®šä¹‰ï¼š</p>

\[\tilde{\pi}(A \times B)=\left\{\begin{array}{ll}
\pi^{\dagger}(A \times B) &amp; \text { if }(A \times B) \cap\left(I_{i} \times J_{j}\right)=\emptyset \text { for all } i, j \\
0 &amp; \text { if } A \times B \subseteq I_{i} \times J_{i} \text { for some } i \\
\pi^{\dagger}(A \times B)+\tilde{\pi}_{12}(A \times B) &amp; \text { if } A \times B \subseteq I_{1} \times J_{2} \\
\pi^{\dagger}(A \times B)+\tilde{\pi}_{21}(A \times B) &amp; \text { if } A \times B \subseteq I_{2} \times J_{1}
\end{array}\right.\]

<p>\(\tilde{\pi}\) æŠŠå°åŒºé—´çš„æµ‹åº¦æŒ–æ‰ï¼Œå¯¹äº \((A \times B) \cap\left(I_{i} \times J_{j}\right) \neq \emptyset\) ä¸” \(A \times B \nsubseteq\left(I_{i} \times J_{j}\right)\) çš„æƒ…å†µï¼Œåˆ©ç”¨è¡¥é›†å®šä¹‰ï¼š</p>

\[\tilde{\pi}(A \times B)=\tilde{\pi}\left((A \times B) \cap\left(I_{i} \times J_{j}\right)\right)+\tilde{\pi}\left((A \times B) \cap\left(I_{i} \times J_{j}\right)^{c}\right)\]

<p>ä¸‹éªŒè¯ \(\tilde{\pi} \in \Pi(\mu, \nu)\)ï¼Œå– \(\tilde{\pi}(\mathbb{R} \times B)\) ç ”ç©¶ï¼š</p>

<ol>
  <li>
    <p>å½“ \(B \cap\left(J_{1} \cup J_{2}\right)=\emptyset\)</p>

\[\tilde{\pi}(\mathbb{R} \times B)=\pi^{\dagger}(\mathbb{R} \times B)=\nu(B)\]
  </li>
  <li>
    <p>å½“ \(B \subseteq J_{1}\)</p>

\[\begin{aligned}
\tilde{\pi}(\mathbb{R} \times B) &amp;=\tilde{\pi}\left(\left(\mathbb{R} \backslash\left(I_{1} \cup I_{2}\right)\right) \times B\right)+\tilde{\pi}\left(I_{1} \times B\right)+\tilde{\pi}\left(I_{2} \times B\right) \\
&amp;=\pi^{\dagger}\left(\left(\mathbb{R} \backslash\left(I_{1} \cup I_{2}\right)\right) \times B\right)+0+\pi^{\dagger}\left(I_{2} \times B\right)+\tilde{\pi}_{21}\left(I_{2} \times B\right) 
\\
&amp; \; \Big\Downarrow \; \tilde{\pi}_{21}\left(I_{2} \times B\right)=\tilde{\nu}_{1}(B)=\pi^{\dagger}\left(I_{1} \times\left(B \cap J_{1}\right)\right)=\pi^{\dagger}\left(I_{1} \times B\right)
\\
&amp;=\pi^{\dagger}\left(\left(\mathbb{R} \backslash I_{1}\right) \times B\right)+\pi^{\dagger}\left(I_{1} \times B\right) \\
&amp;=\pi^{\dagger}(\mathbb{R} \times B) \\
&amp;=\nu(B)
\end{aligned}\]

    <p>å¯¹äº \(B \subseteq J_{2}\) æ˜¯ä¸€æ ·çš„ï¼Œæœ‰ \(\tilde{\pi}(\mathbb{R} \times B)=\nu(B)\)ï¼ŒåŒç†æœ‰ \(\tilde{\pi}(A \times \mathbb{R})=\mu(A)\)ï¼Œæ¨å‡º \(\tilde{\pi} \in \Pi(\mu, \nu)\)</p>
  </li>
</ol>

<p>ä¸‹è¯ \(\tilde{\pi}\) æ˜¯æœ€ä¼˜ä¼ è¾“ï¼š</p>

\[\begin{aligned}
&amp; \int_{\mathbb{R} \times \mathbb{R}} d(x-y) \mathrm{d} \pi^{\dagger}(x, y)-\int_{\mathbb{R} \times \mathbb{R}} d(x-y) \mathrm{d} \tilde{\pi}(x, y) 
\\
&amp;=\int_{I_{1} \times J_{1} \cup I_{2} \times J_{2}} d(x-y) \mathrm{d} \pi^{\dagger}(x, y)-\int_{I_{1} \times J_{2}} d(x-y) \mathrm{d} \tilde{\pi}_{12}(x, y) 
-\int_{I_{2} \times J_{1}} d(x-y) \mathrm{d} \tilde{\pi}_{21}(x, y) 
\\
&amp; \geq \delta\left(d\left(x_{1}-y_{1}\right)-\varepsilon\right)+\delta\left(d\left(x_{2}-y_{2}\right)-\varepsilon\right)-\delta\left(d\left(x_{1}-y_{2}\right)+\varepsilon\right)-\delta\left(d\left(x_{2}-y_{1}\right)+\varepsilon\right) 
\\
&amp;\geq \delta(\eta-4 \varepsilon) 
\\
&amp;&gt;0
\end{aligned}\]

<p>ä¸ \(\pi^{\dagger}\) æ˜¯æœ€ä¼˜ä¼ è¾“çŸ›ç›¾ï¼Œå› æ­¤çŸ¥é“ \(\operatorname{supp}\left(\pi^{\dagger}\right)\) åœ¨ä¼ è¾“ä»£ä»· \(d\) çš„æ„ä¹‰ä¸‹å•è°ƒ</p>

<h4 id="proof-of-theorem-21">Proof of Theorem 2.1</h4>

<p>æœ‰ä¼ è¾“ä»£ä»·å‡½æ•° \(d\) ä¸¥æ ¼å‡¸ï¼Œè¿ç»­ï¼Œç”±åº·æ‰˜æ´›ç»´å¥‡ä¼ è¾“é—®é¢˜æœ€ä¼˜è§£çš„å­˜åœ¨æ€§ï¼ŒçŸ¥å­˜åœ¨ \(\pi^{*} \in \prod(\mu, \nu)\) ä¸ºæœ€ä¼˜ä¼ è¾“è®¡åˆ’ï¼Œä¸‹è¯ \(\pi^{*}=\pi^{\dagger}\)</p>

<ol>
  <li>\(\operatorname{supp}\left(\pi^{\dagger}\right)\) åœ¨ä¼ è¾“ä»£ä»· \(d\) çš„æ„ä¹‰ä¸‹å•è°ƒï¼Œç”±ä¼ è¾“ä»£ä»·å‡½æ•° \(d\) ä¸¥æ ¼å‡¸ï¼Œ \(\operatorname{supp}\left(\pi^{\dagger}\right)\) å°±æœ‰æ›´å¼ºçš„æ€§è´¨ï¼š</li>
</ol>

\[\forall \left(x_{1}, y_{1}\right),\left(x_{2}, y_{2}\right) \in \Gamma,  x_{1}&lt;x_{2} \Rightarrow y_{1} \leq y_{2}\]

<p>è¿™ä¸€ç‚¹åˆ©ç”¨ \(d\) ä¸¥æ ¼å‡¸è¯æ˜ï¼Œåè¯æ³•å‡è®¾ \(y_{1} \leq y_{2}\)ï¼Œè®¾ \(a=x_{1}-y_{1}, b=x_{2}-y_{2},\delta=x_{2}-x_{1}\)ï¼Œç”±æ”¯æ’‘é›†å•è°ƒï¼š</p>

\[d(a)+d(b) \leq d(b-\delta)+d(a+\delta)\]

<p>è®¾ \(t=\frac{\delta}{b-a} \in \left( 0,1 \right)\) ï¼Œåˆ™æœ‰ \(b-\delta=(1-t) b+t a, a+\delta=t b+(1-t) a\)ï¼Œåˆ©ç”¨ Jenson ä¸ç­‰å¼çŸ¥ï¼š</p>

\[d(b-\delta)+d(a+\delta)&lt;(1-t) d(b)+t d(a)+t d(b)+(1-t) d(a)=d(b)+d(a)\]

<p>è¿™ä¸å•è°ƒæ€§çŸ›ç›¾ï¼Œåˆ™æ”¯æ’‘é›†æœ‰ \(\forall\left(x_{1}, y_{1}\right),\left(x_{2}, y_{2}\right) \in \Gamma, x_{1}&lt;x_{2} \Rightarrow y_{1} \leq y_{2}\)</p>

<ol>
  <li>
    <p>åˆ©ç”¨æ”¯æ’‘é›†çš„æ€§è´¨ï¼Œå¯ä»¥è¯æ˜ \(\pi^{*}((-\infty, x],(-\infty, y])=\min \{F(x), G(y)\}\) ï¼Œå³ \(\pi^{\dagger}=\pi^{*}\)ï¼š</p>

    <p>ä»¤ \(A=(-\infty, x] \times(y,+\infty), B=(x,+\infty) \times(-\infty, y]\)ï¼Œç”±\(\left(x_{1}, y_{1}\right),\left(x_{2}, y_{2}\right) \in \Gamma , x_{1} \leq x_{2} \Rightarrow y_{1} \leq y_{2}\)ï¼Œè‹¥æœ‰ \(\left(x_{0}, y_{0}\right) \in \Gamma\)ï¼Œåˆ™</p>

\[\Gamma \subset\left\{(x, y): x \leq x_{0}, y \leq y_{0}\right\} \cup\left\{(x, y): x \geq x_{0}, y \geq y_{0}\right\}\]

    <p style="text-align: center;"><img src="/images/2021-01-20-Optimal-Transport-Note-Part-1/optplan_supp.png" alt="optplan_supp" style="zoom:40%;" /></p>

    <p>å¦‚å›¾æ‰€ç¤ºï¼Œç”±äºæ”¯æ’‘é›†çš„æ€§è´¨ï¼Œæœ‰ \(\pi(A) * \pi(B)=0\)ï¼ŒçŸ¥é“ \(\pi^{*}\)æµ‹åº¦ä¸å¤§äºï¼š</p>

\[\begin{aligned}
\pi^{*}((-\infty, x] \times(-\infty, y])=\min \{&amp; \pi^{*}(((-\infty, x] \times(-\infty, y]) \cup A),
\left.\pi^{*}(((-\infty, x] \times(-\infty, y]) \cup B)\right\} .
\end{aligned}\]

    <p>è¿›ä¸€æ­¥çš„ï¼Œç”±äº</p>

\[\begin{array}{l}
\pi^{*}(((-\infty, x] \times(-\infty, y]) \cup A)=\pi((-\infty, x] \times \mathbb{R})=F(x) \\
\pi^{*}(((-\infty, x] \times(-\infty, y]) \cup B)=\pi(\mathbb{R} \times(-\infty, y])=G(y)
\end{array}\]

    <p>é‚£ä¹ˆ \(\pi^{*}((-\infty, x] \times(-\infty, y])=\min \{F(x), G(y)\}=\pi^{\dagger}((-\infty, x] \times(-\infty, y])\)ï¼Œç”±æ­¤å¯çŸ¥ \(\pi^{\dagger}\) ä¸ºåº·æ‰˜æ´›ç»´å¥‡æœ€ä¼˜ä¼ è¾“</p>
  </li>
  <li>
    <p>æœ€åè¯ä¸€ç»´æœ€ä¼˜ä¼ è¾“çš„ç­‰ä»·æ€§ï¼Œ\(\int_{\mathbb{R} \times \mathbb{R}} d(x-y) \mathrm{d} \pi^{\dagger}(x, y)=\int_{0}^{1} d\left(F^{-1}(t)-G^{-1}(t)\right) \mathrm{d} t\)ï¼Œä¹Ÿç­‰ä»·äº \(\pi^{\dagger}=\left(F^{-1}, G^{-1}\right)_{\#} \mathcal{L}\lfloor[0,1]\)</p>
  </li>
</ol>

\[\begin{aligned}
   \left(F^{-1}, G^{-1}\right)_{\#} \mathcal{L}\lfloor[0,1]((-\infty, x] \times(-\infty, y])&amp;=\mathcal{L} L_{[0,1]}\left(\left(F^{-1}, G^{-1}\right)^{-1}((-\infty, x] \times(-\infty, y])\right) \\
   &amp;=\mathcal{L}\left\lfloor_{[0,1]}\left(\left\{t: F^{-1}(t) \leq x \text { and } G^{-1}(t) \leq y\right\}\right)\right.\\
   &amp;=\mathcal{L}\lfloor[0,1](\{t: F(x) \geq t \text { and } G(y) \geq t\})\\
   &amp;=\min \{F(x), G(y)\} \\
   &amp;=\pi^{\dagger}((-\infty, x] \times(-\infty, y])
   \end{aligned}\]

<p>è¿›ä¸€æ­¥çš„ï¼Œç”±äºå˜é‡å˜æ¢å…¬å¼ï¼š</p>

\[\int_{\mathbb{R} \times \mathbb{R}} d(x-y) \mathrm{d} \pi^{\dagger}(x, y)=\int_{\mathbb{R} \times \mathbb{R}} d(x-y) \mathrm{d}\left(\left(F^{-1}, G^{-1}\right)_{\#} \mathcal{L}\right)(x, y)=\int_{0}^{1} d\left(F^{-1}(t)-G^{-1}(t)\right) \mathrm{d} t\]

<h3 id="optimal-transport-for-discrete-measures">Optimal Transport for Discrete Measures</h3>

<p>è’™æ—¥å½¢å¼æœ€ä¼˜ä¼ è¾“ï¼Œåœ¨ä¼ è¾“ä»£ä»· \(d\) å½¢å¼ä¸å®šæ—¶ï¼Œå­˜åœ¨æ€§å¾ˆéš¾è¯æ˜ï¼Œä½†æ˜¯åœ¨é™å®šä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚ç¦»æ•£æµ‹åº¦ä¸‹ï¼Œåˆ™å¯ä»¥æ„é€ è’™æ—¥ä¼ è¾“æ˜ å°„é›†éç©ºçš„æƒ…å†µï¼Œå…¶è’™æ—¥å½¢å¼æœ€ä¼˜ä¼ è¾“ä¸€å®šå­˜åœ¨ï¼Œå…·ä½“è®¾å®šå¦‚ä¸‹ï¼š</p>

<p>ç­‰æ•°é‡ï¼Œç­‰å¯†åº¦çš„ä¸¤ä¸ªæµ‹åº¦ \(\mu=\frac{1}{n} \sum_{i=1}^{n} \delta_{x_{i}},\nu=\frac{1}{n} \sum_{j=1}^{n} \delta_{y_{j}}\) ,è¿™ç§æƒ…å†µä¸‹è’™æ—¥ä¼ è¾“æ˜ å°„ \(T: X \rightarrow Y\) ä¸€å®šå­˜åœ¨ï¼Œæ¯”å¦‚</p>

\[T\left(x_{i}\right)=y_{\sigma(i)} \quad \sigma:\{1, \ldots, n\} \rightarrow\{1, \ldots, n\}\]

<p>å¯¹äºå·´æ‹¿èµ«ç©ºé—´ \(M\) ä¸­ä¸€ä¸ªå‡¸ï¼Œç´§çš„é›†åˆ \(B\) ï¼Œå®šä¹‰å…¶æå€¼ç‚¹é›†åˆ \(\mathcal{E}(B)\)ï¼Œä»£è¡¨é‚£äº›ä»…æœ‰å¹³å‡¡å‡¸ç»„åˆçš„ç‚¹ï¼š</p>

\[B \ni \pi=\sum_{i=1}^{m} \alpha_{i} \pi_{i}ï¼Œ\pi \in \mathcal{E}(B) \Leftrightarrow \alpha_{i} \in\{0,1\}\]

<p>ä¼šæœ‰ä¸¤ä¸ªç»“è®ºï¼š</p>

<h4 id="theorem-25-minkowskicarathÃ©odory-theorem">Theorem 2.5. Minkowskiâ€“CarathÃ©odory Theorem.</h4>

<p>\(B \subset \mathbb{R}^{M}\) æ˜¯ä¸€ä¸ªéç©ºï¼Œå‡¸çš„ï¼Œç´§é›†åˆï¼Œ\(\forall  \pi^{\dagger} \in B ,\exists  \; \eta\) ï¼Œå…¶æ”¯æ’‘é›†æ˜¯\(\; \mathcal{E}(B)\) ï¼Œå¯¹äºä»»æ„ä»¿å°„å‡½æ•° \(f\) :</p>

\[f\left(\pi^{\dagger}\right)=\int f(\pi) \mathrm{d} \eta(\pi)\]

<p>æˆ–è€…è¯´ï¼Œä¸€ä¸ªå‡¸åŒ… \(B\) ä¸­çš„ç‚¹ \(\pi^{\dagger}\)ï¼Œåˆ©ç”¨å‡¸åŒ…çš„æç‚¹é›†\(\; \mathcal{E}(B)\) å°±å¯ä»¥å‡¸è¡¨ç¤ºï¼Œä¸”è‡³å¤šç”¨ \(\operatorname{dim}(B)+1\) å³å¯è¡¨ç¤ºï¼Œä¸”åŸºä¸ \(\pi^{\dagger}\) æ— å…³</p>

<p style="text-align: center;"><img src="/images/2021-01-20-Optimal-Transport-Note-Part-1/Caratheodorys_theorem_example.svg.png" alt="Caratheodorys_theorem_example.svg" style="zoom:45%;" /></p>

<p>åˆ©ç”¨æ•°å½’è¯æ˜ï¼šå‡è®¾åœ¨ \(d-1\) çš„æƒ…å†µä¸‹éƒ½å¯ä»¥å¦‚æ­¤è¡¨ç¤º</p>

<p>åœ¨ \(d\) ç»´ä¸­ï¼Œå– \(\pi^{\dagger} \in Bï¼Œ\pi^{\dagger} \notin \mathcal{E}(B)\)ï¼Œåœ¨æç‚¹é›†ä¸­å– \(\pi^{(0)} \in \mathcal{E}(B)\)ï¼Œåšçº¿æ®µ \(\left[\pi^{(0)}, \pi^{\dagger}\right]\) å¹¶å»¶é•¿ç›´åˆ°ä¸ \(B\) çš„è¾¹ç•Œç›¸äº¤ä¸ºç‚¹ \(\xi\) ï¼Œåˆ™çº¿æ®µå¯ä»¥è¡¨ç¤ºï¼Œå…¶å‚æ•°é›†ä¸º\(\left\{\theta:(1-\theta) \pi^{(0)}+\theta \pi^{\dagger} \in B\right\}=[0, \alpha]\)ï¼Œåè¿‡æ¥è¡¨å‡º \(\xi=(1-\alpha) \pi^{(0)}+\alpha \pi\)ï¼ŒåŒæ—¶æœ‰ \(\pi^{\dagger}=\left(1-\theta_{0}\right) \xi+\theta_{0} \pi^{(0)},\theta_{0}=1-\frac{1}{\alpha}\) ï¼Œç”± \(\xi\) åœ¨è¾¹ç•Œä¸Šï¼Œåˆ™ä¸º \(d-1\) çš„æƒ…å†µï¼Œå¯ä»¥åŸºè¡¨ç¤ºï¼š\(\xi=\sum_{i=1}^{n} \theta_{i} \pi^{(i)}ï¼Œ\sum_{i=1}^{d} \theta_{i}=1\)ï¼Œå› æ­¤æœ‰</p>

\[\pi^{\dagger}=\sum_{i=1}^{d}\left(1-\theta_{0}\right) \theta_{i} \pi^{(i)}+\theta_{0} \pi^{(0)}
\\
\left(1-\theta_{0}\right) \sum_{i=1}^{d} \theta_{i}+\theta_{0}=1\]

<p>å› æ­¤å¯ä»¥ \(\pi^{\dagger}\) å¯ä»¥å‡¸è¡¨ç¤ºï¼Œä¸” \(\pi^{\dagger}\) çš„é€‰æ‹©ä¸ \(\pi^{(0)}\) æ— å…³</p>

<h4 id="theorem-26-birkhoffs-theorem">Theorem 2.6. Birkhoffâ€™s theorem</h4>

<p>ç¦»æ•£å½¢å¼çš„æœ€ä¼˜ä¼ è¾“ï¼Œç­‰ä»·äºä¸€ä¸ªçº¿æ€§è§„åˆ’ï¼Œå¯ä»¥åˆ©ç”¨ä¸€ä¸ª \(\mathbb{R}^{n \times n}\) è¡¨ç¤ºï¼Œç§°ä¸º Bistochastic çŸ©é˜µï¼Œå…·ä½“æ¥è¯´æ˜¯ï¼š</p>

\[B=\left\{\pi \in \mathbb{R}^{n \times n}: \forall i j, \pi_{i j} \geq 0 ; \forall j, \sum_{i=1}^{n} \pi_{i j}=1 ; \forall i, \sum_{j=1}^{n} \pi_{i j}=1\right\}\]

<p>Birkhoffâ€™s theoremæŒ‡å‡ºäº†è¿™æ ·çš„çŸ©é˜µçš„æç‚¹é›†ä¸ºç½®æ¢çŸ©é˜µï¼š</p>

\[\mathcal{E}(B)=\left\{\pi \in\{0,1\}^{n \times n}: \forall j, \sum_{i=1}^{n} \pi_{i j}=1 ; \forall i, \sum_{j=1}^{n} \pi_{i j}=1\right\}\]

<ol>
  <li>
    <p>å…ˆè¯æ˜ç½®æ¢çŸ©é˜µæ˜¯æå€¼ç‚¹ï¼š</p>

    <p>è®¾çŸ©é˜µ \(\pi\)ï¼Œå®šä¹‰ \(\pi_{i j}=\delta_{j=\sigma(i)}\) ä¸” \(\pi \notin \mathcal{E}(B)\)ï¼Œå› æ­¤å­˜åœ¨å¼‚äº \(\pi\) çš„ä¸¤ç‚¹  \(\pi^{(1)}, \pi^{(2)} \in B\)ï¼Œä¸”èƒ½è¡¨è¾¾ \(\pi\) ï¼Œä¸º \(\pi=t \pi^{(1)}+(1-t) \pi^{(2)}ï¼Œt \in(0,1)\)ï¼Œå– \(\pi\) ä¸­ä¸º 0 çš„åˆ†é‡ï¼š</p>

\[0=\pi_{i j}=t \pi_{i j}^{(1)}+(1-t) \pi_{i j}^{(2)} \Longrightarrow \quad \pi_{i j}^{(2)}=-\frac{\pi_{i j}^{(1)}}{1-t}&lt;0\]

    <p>è¿™ä¸ä¹‹å‰å¯¹äºä¼ è¾“çŸ©é˜µçš„å®šä¹‰çŸ›ç›¾ï¼Œåˆ™ç½®æ¢çŸ©é˜µä¸€å®šæ˜¯æå€¼ç‚¹</p>
  </li>
  <li>
    <p>åœ¨è¯æ˜æå€¼ç‚¹é›†åˆ \(\pi \in \mathcal{E}(B)\) çš„å…ƒç´ æ˜¯ç½®æ¢çŸ©é˜µï¼š</p>

    <ul>
      <li>
        <p>å…ˆè¯æ˜æå€¼ç‚¹ä¸­å…ƒç´ å½¢å¼ä¸º \(\pi_{i j} \in\{0,1\}\)ï¼š</p>

        <p>å–ä¸€ä¸ªæç‚¹é›†ä¸­å…ƒç´  \(\pi \in \mathcal{E}(B)\)ï¼Œä¸”ä¸æ»¡è¶³  \(\pi_{i j} \in\{0,1\}\)ï¼Œåˆ™åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¯ä»¥åœ¨è½®æµæ§åˆ¶æŒ‡æ ‡ \(i,j\) çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ \(\sum_{i=1}^{n} \pi_{i j_{1}}=1\) å’Œ \(\sum_{j=1}^{n} \pi_{i_{2} j}=1\) ç›´åˆ°æœ‰ \(i_{m}=\imath_{1}\) æ—¶ï¼Œæ¯”å¦‚å¯¹äº \(\pi_{i_{1} j_{1}} \in(0,1)\)ï¼Œ\(\exists  \pi_{i_{2} j_{1}} \in(0,1)ï¼Œs.t \; \sum_{i=1}^{n} \pi_{i j_{1}}=1\)</p>

        <p>äºæ˜¯æœ‰ä¸¤åˆ—åºåˆ—ï¼š</p>

\[\mathcal{I}=\left\{i_{k} j_{k}: k \in\{1, \ldots, m-1\}\right\} \quad \mathcal{I}^{+}=\left\{i_{k+1} j_{k}: k \in\{1, \ldots, m-1\}\right\}\]

        <p>å…¶æœ‰æ€§è´¨ï¼š\(i_{k+1} \neq i_{k} \text { and } j_{k+1} \neq j_{k}\)ï¼Œå¹¶å®šä¹‰åœ¨ \(\pi\) ä¸Šå®šä¹‰æ‰°åŠ¨ï¼š</p>

\[\pi_{i j}^{(\delta)}=\left\{\begin{array}{ll}
\pi_{i_{k} j_{k}}+\delta &amp; \text { if } i j=i_{k} j_{k} \text { for some } k \\
\pi_{i_{k+1} j_{k}}-\delta &amp; \text { if } i j=i_{k+1} j_{k} \text { for some } k \\
\pi_{i j} &amp; \text { else }
\end{array}\right.\]

        <table>
          <tbody>
            <tr>
              <td>éªŒè¯ $$\sum_{i=1}^{n} \pi_{i j}^{(\delta)}=\sum_{i=1}^{n} \pi_{i j}+\delta</td>
              <td>{i j \in \mathcal{I}: i \in{1, \ldots, n}}</td>
              <td>-\delta\left</td>
              <td>\left{i j \in \mathcal{I}^{+}: i \in{1, \ldots, n}\right}\right</td>
              <td>$$</td>
            </tr>
          </tbody>
        </table>

        <p>ç”±äº \(i j \in \mathcal{I} \Leftrightarrow  \exists  \; i^{\prime} , \; s.t \quad i^{\prime} j \in \mathcal{I}^{+}\) å¯çŸ¥æŒ‡æ ‡é›†å¤§å°ä¸€æ ·ï¼Œåˆ™ï¼š</p>

\[\sum_{i=1}^{n} \pi_{i j}^{(\delta)}=1ï¼Œ\sum_{j=1}^{n} \pi_{i j}^{(\delta)}=1\]

        <p>æ§åˆ¶æ‰°åŠ¨ \(\delta=\min \left\{\min \left\{\pi_{i j}, 1-\pi_{i j}\right\}: i j \in \mathcal{I} \cup \mathcal{I}^{+}\right\} \in(0,1)\) ï¼Œåˆ™å¯ä»¥å®šä¹‰ \(\pi^{(1)}=\pi^{(-\delta)} \neq \pi^{(2)}=\pi^{(\delta)}\)ï¼Œä¸” \(\pi^{(1)}, \pi^{(2)} \in B\) ï¼Œè¿›ä¸€æ­¥çš„å¯ä»¥æ„é€ å‡º \(\pi\):</p>

\[\pi=\frac{1}{2} \pi^{(1)}+\frac{1}{2} \pi^{(2)}\]

        <p>è¿™ä¸æç‚¹é›†çš„æ¡ä»¶çŸ›ç›¾ï¼Œå› æ­¤çŸ¥é“æç‚¹é›†ä¸­çš„å…ƒç´ æœ‰å½¢å¼ï¼š\(\pi_{i j} \in\{0,1\}\)</p>
      </li>
      <li>
        <p>åœ¨è¯æ˜è¿™æ ·çš„ \(\pi\) æ˜¯ä¸€ä¸ªç½®æ¢ï¼Œè¿™æ ¹æ® \(\forall \; i , \exists  \; j^* ,s.t \; \pi_{i j^{*}}=1\) å°±å¯ä»¥å¾—çŸ¥</p>
      </li>
    </ul>
  </li>
</ol>

<h4 id="theorem-27-existence-of-optimal-transport-map-of-discrete-measurement">Theorem 2.7 Existence of Optimal Transport Map of Discrete Measurement</h4>

<p>å¯¹äºç¦»æ•£æµ‹åº¦çš„ \(\mu=\frac{1}{n} \sum_{i=1}^{n} \delta_{x_{i}}, \nu=\frac{1}{n} \sum_{j=1}^{n} \delta_{y_{j}}\)ï¼Œå­˜åœ¨è’™æ—¥å½¢å¼çš„æœ€ä¼˜ä¼ è¾“æ˜ å°„</p>

<p>åœ¨ \(c_{i j}=c\left(x_{i}, y_{j}\right)\) æ„ä¹‰ä¸‹ï¼Œåˆ©ç”¨ Bistochastic çŸ©é˜µï¼Œ\(B=\left\{\pi \in \mathbb{R}^{n \times n}: \forall i j, \pi_{i j} \geq 0 ; \forall j, \sum_{i=1}^{n} \pi_{i j}=1 ; \forall i, \sum_{j=1}^{n} \pi_{i j}=1\right\}\)ï¼Œåº·æ‰˜æ´›ç»´å¥‡ç¦»æ•£å½¢å¼å¯ä»¥å†™æˆï¼š</p>

\[\text { minimise } \frac{1}{n} \sum_{i, j} c_{i j} \pi_{i j} \quad \text { over } \pi \in B\]

<p>å­˜åœ¨ \(M\) ä¸ºåº·æ‰˜æ´›ç»´å¥‡å½¢å¼çš„æœ€å°ï¼Œ\(\varepsilon&gt;0\) æœ‰å¹¶åšä¸€ä¸ªé€¼è¿‘ \(\pi^{\varepsilon} \in B\)</p>

\[M \geq \sum_{i j} c_{i j} \pi^{\varepsilon}-\varepsilon\]

<p>ä»¤ \(f(\pi)=\sum_{i j} c_{i j} \pi_{i j}\)ï¼Œç”± \(B\) æ˜¯ç´§çš„ï¼Œå‡¸çš„ï¼Œå­˜åœ¨ä¸€ä¸ªæ”¯æ’‘é›†ä¸º\(\mathcal{E}(B)\) çš„æµ‹åº¦ \(\eta\) ï¼Œç”± Minkowskiâ€“CarathÃ©odory Theorem çŸ¥ï¼š</p>

\[f\left(\pi^{\varepsilon}\right)=\int f(\pi) \mathrm{d} \eta(\pi)\]

<p>å› æ­¤ï¼Œå¯ä»¥æ”¾ä¸‹ç•Œï¼š</p>

\[M \geq \int \sum_{i j} c_{i j} \pi_{i j} \mathrm{~d} \eta(\pi)-\varepsilon \geq \inf _{\pi \in \mathcal{E}(B)} \sum_{i j} c_{i j} \pi_{i j}-\varepsilon \geq M-\varepsilon\]

<p>å– \(\varepsilon \rightarrow 0\)ï¼Œåˆ™ \(\inf _{\pi \in \mathcal{E}(B)} \sum_{i j} c_{i j} \pi_{i j}=M\)ï¼Œç”± \(\mathcal{E}(B)\) ç´§ï¼Œåˆ™ \(\pi^{\dagger} \in \mathcal{E}(B)\)ï¼Œç”± Birkhoffâ€™s theorem çŸ¥æå€¼ç‚¹ä¸ºç½®æ¢çŸ©é˜µï¼Œäºæ˜¯åº·æ‰˜æ´›ç»´å¥‡æœ€ä¼˜ä¼ è¾“å¯ä»¥å†™æˆä¸€ä¸ªç½®æ¢çŸ©é˜µ \(\sigma^{\dagger}:\{1, \ldots, n\} \rightarrow\{1, \ldots, n\}\)  \(\pi_{i j}^{\dagger}=\delta_{j=\sigma^{\dagger}(i)}\)ï¼Œå› æ­¤å¯ä»¥å®šä¹‰è’™æ—¥ä¼ è¾“ \(T^{\dagger}: X \rightarrow Y\)ï¼š</p>

\[T^{\dagger}\left(x_{i}\right)=y_{\sigma}(i)\]

<p>å½“å®šä¹‰ä¸€ä¸ªæ™®é€šçš„åº·æ‰˜æ´›ç»´å¥‡ä¼ è¾“è®¡åˆ’ \(\pi_{i j}=\delta_{y_{j}=T\left(x_{i}\right)}\) å¯çŸ¥ï¼š</p>

\[\sum_{i=1}^{n} c\left(x_{i}, T\left(x_{i}\right)\right)=\sum_{i j} c_{i j} \pi_{i j} \geq \sum_{i j} c_{i j} \pi_{i j}^{\dagger}=\sum_{i=1}^{n} c\left(x_{i}, T^{\dagger}\left(x_{i}\right)\right)\]

<p>ç”±æ­¤è’™æ—¥å½¢å¼ç­‰ä»·äºåº·æ‰˜æ´›ç»´å¥‡å½¢å¼ï¼Œ\(T^{\dagger}\) æ˜¯è’™æ—¥æœ€ä¼˜ä¼ è¾“</p>
:ET